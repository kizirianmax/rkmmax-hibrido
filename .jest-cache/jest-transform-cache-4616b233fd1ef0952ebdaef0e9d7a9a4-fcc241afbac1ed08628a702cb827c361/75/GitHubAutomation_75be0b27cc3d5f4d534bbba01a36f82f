76269460c99cb40f40e33ca39b228b93
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
/**
 * GITHUB AUTOMATION
 * Integra√ß√£o completa com GitHub para commits, pushes e PRs autom√°ticos
 * Suporta: Criar commits, fazer push, criar PRs, gerenciar branches
 */

class GitHubAutomation {
  constructor(token) {
    this.token = token || process.env.GITHUB_TOKEN;
    this.baseUrl = "https://api.github.com";
    this.headers = {
      Accept: "application/vnd.github.v3+json",
      Authorization: `token ${this.token}`,
      "User-Agent": "RKMMAX-Automation"
    };
    if (!this.token) {
      throw new Error("GITHUB_TOKEN n√£o configurado");
    }
  }

  /**
   * Obter informa√ß√µes do reposit√≥rio
   */
  async getRepositoryInfo(owner, repo) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`GitHub API error: ${response.status}`);
      }
      const data = await response.json();
      return {
        name: data.name,
        owner: data.owner.login,
        url: data.html_url,
        defaultBranch: data.default_branch,
        isPrivate: data.private,
        description: data.description
      };
    } catch (error) {
      throw new Error(`Erro ao obter info do repo: ${error.message}`);
    }
  }

  /**
   * Obter refer√™ncia de branch (SHA)
   */
  async getBranchRef(owner, repo, branch = "main") {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs/heads/${branch}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Branch n√£o encontrado: ${branch}`);
      }
      const data = await response.json();
      return {
        branch,
        sha: data.object.sha,
        url: data.url
      };
    } catch (error) {
      throw new Error(`Erro ao obter branch: ${error.message}`);
    }
  }

  /**
   * Obter √°rvore de commits
   */
  async getCommitTree(owner, repo, sha) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/commits/${sha}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Commit n√£o encontrado: ${sha}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        message: data.message,
        author: data.author,
        tree: data.tree
      };
    } catch (error) {
      throw new Error(`Erro ao obter √°rvore: ${error.message}`);
    }
  }

  /**
   * Criar blob (arquivo)
   */
  async createBlob(owner, repo, content, encoding = "utf-8") {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/blobs`, {
        method: "POST",
        headers: this.headers,
        body: JSON.stringify({
          content,
          encoding
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar blob: ${response.status}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        url: data.url
      };
    } catch (error) {
      throw new Error(`Erro ao criar blob: ${error.message}`);
    }
  }

  /**
   * Criar √°rvore de arquivos
   */
  async createTree(owner, repo, files, baseTreeSha = null) {
    try {
      const tree = [];
      for (const file of files) {
        // Se for arquivo novo
        if (file.content) {
          const blob = await this.createBlob(owner, repo, file.content);
          tree.push({
            path: file.path,
            mode: "100644",
            // arquivo regular
            type: "blob",
            sha: blob.sha
          });
        }
        // Se for deletar arquivo
        else if (file.delete) {
          tree.push({
            path: file.path,
            mode: "100644",
            type: "blob",
            sha: null
          });
        }
      }
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/trees`, {
        method: "POST",
        headers: this.headers,
        body: JSON.stringify({
          tree,
          base_tree: baseTreeSha
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar √°rvore: ${response.status}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        url: data.url
      };
    } catch (error) {
      throw new Error(`Erro ao criar √°rvore: ${error.message}`);
    }
  }

  /**
   * Criar commit
   */
  async createCommit(owner, repo, message, treeSha, parentSha, author) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/commits`, {
        method: "POST",
        headers: this.headers,
        body: JSON.stringify({
          message,
          tree: treeSha,
          parents: [parentSha],
          author: {
            name: author?.name || "RKMMAX Bot",
            email: author?.email || "bot@rkmmax.com",
            date: new Date().toISOString()
          }
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar commit: ${response.status}`);
      }
      const data = await response.json();
      return {
        sha: data.sha,
        message: data.message,
        author: data.author,
        url: data.html_url
      };
    } catch (error) {
      throw new Error(`Erro ao criar commit: ${error.message}`);
    }
  }

  /**
   * Atualizar refer√™ncia (fazer push)
   */
  async updateRef(owner, repo, branch, newSha, force = false) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs/heads/${branch}`, {
        method: "PATCH",
        headers: this.headers,
        body: JSON.stringify({
          sha: newSha,
          force
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao atualizar refer√™ncia: ${response.status}`);
      }
      const data = await response.json();
      return {
        branch,
        sha: data.object.sha,
        updated: true
      };
    } catch (error) {
      throw new Error(`Erro ao fazer push: ${error.message}`);
    }
  }

  /**
   * Fluxo completo: Commit + Push
   */
  async commitAndPush(owner, repo, files, message, branch = "main", author = null) {
    try {
      console.log(`üìù Iniciando commit em ${owner}/${repo}/${branch}`);

      // 1. Obter refer√™ncia atual do branch
      const branchRef = await this.getBranchRef(owner, repo, branch);
      console.log(`‚úÖ Branch encontrado: ${branchRef.sha.substring(0, 7)}`);

      // 2. Obter √°rvore atual
      const currentTree = await this.getCommitTree(owner, repo, branchRef.sha);
      console.log(`‚úÖ √Årvore obtida: ${currentTree.tree.sha.substring(0, 7)}`);

      // 3. Criar nova √°rvore com os arquivos
      const newTree = await this.createTree(owner, repo, files, currentTree.tree.sha);
      console.log(`‚úÖ Nova √°rvore criada: ${newTree.sha.substring(0, 7)}`);

      // 4. Criar novo commit
      const newCommit = await this.createCommit(owner, repo, message, newTree.sha, branchRef.sha, author);
      console.log(`‚úÖ Commit criado: ${newCommit.sha.substring(0, 7)}`);

      // 5. Fazer push (atualizar refer√™ncia)
      const push = await this.updateRef(owner, repo, branch, newCommit.sha);
      console.log(`‚úÖ Push realizado com sucesso!`);
      return {
        success: true,
        commit: newCommit,
        branch: push.branch,
        filesChanged: files.length
      };
    } catch (error) {
      console.error(`‚ùå Erro no commit/push: ${error.message}`);
      throw error;
    }
  }

  /**
   * Criar Pull Request
   */
  async createPullRequest(owner, repo, title, body, head, base = "main") {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/pulls`, {
        method: "POST",
        headers: this.headers,
        body: JSON.stringify({
          title,
          body,
          head,
          base
        })
      });
      if (!response.ok) {
        const error = await response.json();
        throw new Error(`Erro ao criar PR: ${error.message}`);
      }
      const data = await response.json();
      return {
        number: data.number,
        title: data.title,
        url: data.html_url,
        status: data.state
      };
    } catch (error) {
      throw new Error(`Erro ao criar PR: ${error.message}`);
    }
  }

  /**
   * Listar arquivos modificados em um commit
   */
  async getCommitFiles(owner, repo, commitSha) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/commits/${commitSha}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Commit n√£o encontrado: ${commitSha}`);
      }
      const data = await response.json();
      return {
        commit: commitSha,
        author: data.commit.author,
        message: data.commit.message,
        files: data.files.map(f => ({
          path: f.filename,
          status: f.status,
          additions: f.additions,
          deletions: f.deletions,
          changes: f.changes
        })),
        stats: {
          total: data.files.length,
          additions: data.stats.additions,
          deletions: data.stats.deletions
        }
      };
    } catch (error) {
      throw new Error(`Erro ao obter arquivos: ${error.message}`);
    }
  }

  /**
   * Obter conte√∫do de arquivo
   */
  async getFileContent(owner, repo, path, branch = "main") {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/contents/${path}?ref=${branch}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Arquivo n√£o encontrado: ${path}`);
      }
      const data = await response.json();

      // Decodificar base64
      const content = Buffer.from(data.content, "base64").toString("utf-8");
      return {
        path: data.path,
        content,
        sha: data.sha,
        size: data.size
      };
    } catch (error) {
      throw new Error(`Erro ao obter arquivo: ${error.message}`);
    }
  }

  /**
   * Criar branch
   */
  async createBranch(owner, repo, branchName, fromBranch = "main") {
    try {
      // Obter SHA do branch origem
      const originBranch = await this.getBranchRef(owner, repo, fromBranch);

      // Criar novo branch
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs`, {
        method: "POST",
        headers: this.headers,
        body: JSON.stringify({
          ref: `refs/heads/${branchName}`,
          sha: originBranch.sha
        })
      });
      if (!response.ok) {
        throw new Error(`Erro ao criar branch: ${response.status}`);
      }
      const data = await response.json();
      return {
        branch: branchName,
        sha: data.object.sha,
        created: true
      };
    } catch (error) {
      throw new Error(`Erro ao criar branch: ${error.message}`);
    }
  }

  /**
   * Deletar branch
   */
  async deleteBranch(owner, repo, branchName) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/git/refs/heads/${branchName}`, {
        method: "DELETE",
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Erro ao deletar branch: ${response.status}`);
      }
      return {
        branch: branchName,
        deleted: true
      };
    } catch (error) {
      throw new Error(`Erro ao deletar branch: ${error.message}`);
    }
  }

  /**
   * Obter hist√≥rico de commits
   */
  async getCommitHistory(owner, repo, branch = "main", limit = 10) {
    try {
      const response = await fetch(`${this.baseUrl}/repos/${owner}/${repo}/commits?sha=${branch}&per_page=${limit}`, {
        headers: this.headers
      });
      if (!response.ok) {
        throw new Error(`Erro ao obter hist√≥rico: ${response.status}`);
      }
      const data = await response.json();
      return data.map(commit => ({
        sha: commit.sha,
        message: commit.commit.message,
        author: commit.commit.author.name,
        date: commit.commit.author.date,
        url: commit.html_url
      }));
    } catch (error) {
      throw new Error(`Erro ao obter hist√≥rico: ${error.message}`);
    }
  }
}

// Exportar
if (typeof module !== "undefined" && module.exports) {
  module.exports = GitHubAutomation;
}
var _default = exports.default = GitHubAutomation;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJHaXRIdWJBdXRvbWF0aW9uIiwiY29uc3RydWN0b3IiLCJ0b2tlbiIsInByb2Nlc3MiLCJlbnYiLCJHSVRIVUJfVE9LRU4iLCJiYXNlVXJsIiwiaGVhZGVycyIsIkFjY2VwdCIsIkF1dGhvcml6YXRpb24iLCJFcnJvciIsImdldFJlcG9zaXRvcnlJbmZvIiwib3duZXIiLCJyZXBvIiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJuYW1lIiwibG9naW4iLCJ1cmwiLCJodG1sX3VybCIsImRlZmF1bHRCcmFuY2giLCJkZWZhdWx0X2JyYW5jaCIsImlzUHJpdmF0ZSIsInByaXZhdGUiLCJkZXNjcmlwdGlvbiIsImVycm9yIiwibWVzc2FnZSIsImdldEJyYW5jaFJlZiIsImJyYW5jaCIsInNoYSIsIm9iamVjdCIsImdldENvbW1pdFRyZWUiLCJhdXRob3IiLCJ0cmVlIiwiY3JlYXRlQmxvYiIsImNvbnRlbnQiLCJlbmNvZGluZyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY3JlYXRlVHJlZSIsImZpbGVzIiwiYmFzZVRyZWVTaGEiLCJmaWxlIiwiYmxvYiIsInB1c2giLCJwYXRoIiwibW9kZSIsInR5cGUiLCJkZWxldGUiLCJiYXNlX3RyZWUiLCJjcmVhdGVDb21taXQiLCJ0cmVlU2hhIiwicGFyZW50U2hhIiwicGFyZW50cyIsImVtYWlsIiwiZGF0ZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZVJlZiIsIm5ld1NoYSIsImZvcmNlIiwidXBkYXRlZCIsImNvbW1pdEFuZFB1c2giLCJjb25zb2xlIiwibG9nIiwiYnJhbmNoUmVmIiwic3Vic3RyaW5nIiwiY3VycmVudFRyZWUiLCJuZXdUcmVlIiwibmV3Q29tbWl0Iiwic3VjY2VzcyIsImNvbW1pdCIsImZpbGVzQ2hhbmdlZCIsImxlbmd0aCIsImNyZWF0ZVB1bGxSZXF1ZXN0IiwidGl0bGUiLCJoZWFkIiwiYmFzZSIsIm51bWJlciIsInN0YXRlIiwiZ2V0Q29tbWl0RmlsZXMiLCJjb21taXRTaGEiLCJtYXAiLCJmIiwiZmlsZW5hbWUiLCJhZGRpdGlvbnMiLCJkZWxldGlvbnMiLCJjaGFuZ2VzIiwic3RhdHMiLCJ0b3RhbCIsImdldEZpbGVDb250ZW50IiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwic2l6ZSIsImNyZWF0ZUJyYW5jaCIsImJyYW5jaE5hbWUiLCJmcm9tQnJhbmNoIiwib3JpZ2luQnJhbmNoIiwicmVmIiwiY3JlYXRlZCIsImRlbGV0ZUJyYW5jaCIsImRlbGV0ZWQiLCJnZXRDb21taXRIaXN0b3J5IiwibGltaXQiLCJtb2R1bGUiLCJleHBvcnRzIiwiX2RlZmF1bHQiLCJkZWZhdWx0Il0sInNvdXJjZXMiOlsiR2l0SHViQXV0b21hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEdJVEhVQiBBVVRPTUFUSU9OXG4gKiBJbnRlZ3Jhw6fDo28gY29tcGxldGEgY29tIEdpdEh1YiBwYXJhIGNvbW1pdHMsIHB1c2hlcyBlIFBScyBhdXRvbcOhdGljb3NcbiAqIFN1cG9ydGE6IENyaWFyIGNvbW1pdHMsIGZhemVyIHB1c2gsIGNyaWFyIFBScywgZ2VyZW5jaWFyIGJyYW5jaGVzXG4gKi9cblxuY2xhc3MgR2l0SHViQXV0b21hdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHRva2VuKSB7XG4gICAgdGhpcy50b2tlbiA9IHRva2VuIHx8IHByb2Nlc3MuZW52LkdJVEhVQl9UT0tFTjtcbiAgICB0aGlzLmJhc2VVcmwgPSBcImh0dHBzOi8vYXBpLmdpdGh1Yi5jb21cIjtcbiAgICB0aGlzLmhlYWRlcnMgPSB7XG4gICAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24vdm5kLmdpdGh1Yi52Mytqc29uXCIsXG4gICAgICBBdXRob3JpemF0aW9uOiBgdG9rZW4gJHt0aGlzLnRva2VufWAsXG4gICAgICBcIlVzZXItQWdlbnRcIjogXCJSS01NQVgtQXV0b21hdGlvblwiLFxuICAgIH07XG5cbiAgICBpZiAoIXRoaXMudG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkdJVEhVQl9UT0tFTiBuw6NvIGNvbmZpZ3VyYWRvXCIpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRlciBpbmZvcm1hw6fDtWVzIGRvIHJlcG9zaXTDs3Jpb1xuICAgKi9cbiAgYXN5bmMgZ2V0UmVwb3NpdG9yeUluZm8ob3duZXIsIHJlcG8pIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb31gLCB7XG4gICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgR2l0SHViIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgb3duZXI6IGRhdGEub3duZXIubG9naW4sXG4gICAgICAgIHVybDogZGF0YS5odG1sX3VybCxcbiAgICAgICAgZGVmYXVsdEJyYW5jaDogZGF0YS5kZWZhdWx0X2JyYW5jaCxcbiAgICAgICAgaXNQcml2YXRlOiBkYXRhLnByaXZhdGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGluZm8gZG8gcmVwbzogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRlciByZWZlcsOqbmNpYSBkZSBicmFuY2ggKFNIQSlcbiAgICovXG4gIGFzeW5jIGdldEJyYW5jaFJlZihvd25lciwgcmVwbywgYnJhbmNoID0gXCJtYWluXCIpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7dGhpcy5iYXNlVXJsfS9yZXBvcy8ke293bmVyfS8ke3JlcG99L2dpdC9yZWZzL2hlYWRzLyR7YnJhbmNofWAsXG4gICAgICAgIHsgaGVhZGVyczogdGhpcy5oZWFkZXJzIH1cbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBCcmFuY2ggbsOjbyBlbmNvbnRyYWRvOiAke2JyYW5jaH1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYnJhbmNoLFxuICAgICAgICBzaGE6IGRhdGEub2JqZWN0LnNoYSxcbiAgICAgICAgdXJsOiBkYXRhLnVybCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBvYnRlciBicmFuY2g6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogT2J0ZXIgw6Fydm9yZSBkZSBjb21taXRzXG4gICAqL1xuICBhc3luYyBnZXRDb21taXRUcmVlKG93bmVyLCByZXBvLCBzaGEpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vZ2l0L2NvbW1pdHMvJHtzaGF9YCwge1xuICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbW1pdCBuw6NvIGVuY29udHJhZG86ICR7c2hhfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzaGE6IGRhdGEuc2hhLFxuICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UsXG4gICAgICAgIGF1dGhvcjogZGF0YS5hdXRob3IsXG4gICAgICAgIHRyZWU6IGRhdGEudHJlZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBvYnRlciDDoXJ2b3JlOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyaWFyIGJsb2IgKGFycXVpdm8pXG4gICAqL1xuICBhc3luYyBjcmVhdGVCbG9iKG93bmVyLCByZXBvLCBjb250ZW50LCBlbmNvZGluZyA9IFwidXRmLThcIikge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9naXQvYmxvYnNgLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGNvbnRlbnQsXG4gICAgICAgICAgZW5jb2RpbmcsXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIGJsb2I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzaGE6IGRhdGEuc2hhLFxuICAgICAgICB1cmw6IGRhdGEudXJsLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIGJsb2I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JpYXIgw6Fydm9yZSBkZSBhcnF1aXZvc1xuICAgKi9cbiAgYXN5bmMgY3JlYXRlVHJlZShvd25lciwgcmVwbywgZmlsZXMsIGJhc2VUcmVlU2hhID0gbnVsbCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0cmVlID0gW107XG5cbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAvLyBTZSBmb3IgYXJxdWl2byBub3ZvXG4gICAgICAgIGlmIChmaWxlLmNvbnRlbnQpIHtcbiAgICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgdGhpcy5jcmVhdGVCbG9iKG93bmVyLCByZXBvLCBmaWxlLmNvbnRlbnQpO1xuICAgICAgICAgIHRyZWUucHVzaCh7XG4gICAgICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgICAgICBtb2RlOiBcIjEwMDY0NFwiLCAvLyBhcnF1aXZvIHJlZ3VsYXJcbiAgICAgICAgICAgIHR5cGU6IFwiYmxvYlwiLFxuICAgICAgICAgICAgc2hhOiBibG9iLnNoYSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBTZSBmb3IgZGVsZXRhciBhcnF1aXZvXG4gICAgICAgIGVsc2UgaWYgKGZpbGUuZGVsZXRlKSB7XG4gICAgICAgICAgdHJlZS5wdXNoKHtcbiAgICAgICAgICAgIHBhdGg6IGZpbGUucGF0aCxcbiAgICAgICAgICAgIG1vZGU6IFwiMTAwNjQ0XCIsXG4gICAgICAgICAgICB0eXBlOiBcImJsb2JcIixcbiAgICAgICAgICAgIHNoYTogbnVsbCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9naXQvdHJlZXNgLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIHRyZWUsXG4gICAgICAgICAgYmFzZV90cmVlOiBiYXNlVHJlZVNoYSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gY3JpYXIgw6Fydm9yZTogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNoYTogZGF0YS5zaGEsXG4gICAgICAgIHVybDogZGF0YS51cmwsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gY3JpYXIgw6Fydm9yZTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmlhciBjb21taXRcbiAgICovXG4gIGFzeW5jIGNyZWF0ZUNvbW1pdChvd25lciwgcmVwbywgbWVzc2FnZSwgdHJlZVNoYSwgcGFyZW50U2hhLCBhdXRob3IpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vZ2l0L2NvbW1pdHNgLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgdHJlZTogdHJlZVNoYSxcbiAgICAgICAgICBwYXJlbnRzOiBbcGFyZW50U2hhXSxcbiAgICAgICAgICBhdXRob3I6IHtcbiAgICAgICAgICAgIG5hbWU6IGF1dGhvcj8ubmFtZSB8fCBcIlJLTU1BWCBCb3RcIixcbiAgICAgICAgICAgIGVtYWlsOiBhdXRob3I/LmVtYWlsIHx8IFwiYm90QHJrbW1heC5jb21cIixcbiAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBjcmlhciBjb21taXQ6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzaGE6IGRhdGEuc2hhLFxuICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UsXG4gICAgICAgIGF1dGhvcjogZGF0YS5hdXRob3IsXG4gICAgICAgIHVybDogZGF0YS5odG1sX3VybCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBjcmlhciBjb21taXQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXR1YWxpemFyIHJlZmVyw6puY2lhIChmYXplciBwdXNoKVxuICAgKi9cbiAgYXN5bmMgdXBkYXRlUmVmKG93bmVyLCByZXBvLCBicmFuY2gsIG5ld1NoYSwgZm9yY2UgPSBmYWxzZSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICBgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vZ2l0L3JlZnMvaGVhZHMvJHticmFuY2h9YCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzaGE6IG5ld1NoYSxcbiAgICAgICAgICAgIGZvcmNlLFxuICAgICAgICAgIH0pLFxuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBhdHVhbGl6YXIgcmVmZXLDqm5jaWE6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBicmFuY2gsXG4gICAgICAgIHNoYTogZGF0YS5vYmplY3Quc2hhLFxuICAgICAgICB1cGRhdGVkOiB0cnVlLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGZhemVyIHB1c2g6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRmx1eG8gY29tcGxldG86IENvbW1pdCArIFB1c2hcbiAgICovXG4gIGFzeW5jIGNvbW1pdEFuZFB1c2gob3duZXIsIHJlcG8sIGZpbGVzLCBtZXNzYWdlLCBicmFuY2ggPSBcIm1haW5cIiwgYXV0aG9yID0gbnVsbCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+TnSBJbmljaWFuZG8gY29tbWl0IGVtICR7b3duZXJ9LyR7cmVwb30vJHticmFuY2h9YCk7XG5cbiAgICAgIC8vIDEuIE9idGVyIHJlZmVyw6puY2lhIGF0dWFsIGRvIGJyYW5jaFxuICAgICAgY29uc3QgYnJhbmNoUmVmID0gYXdhaXQgdGhpcy5nZXRCcmFuY2hSZWYob3duZXIsIHJlcG8sIGJyYW5jaCk7XG4gICAgICBjb25zb2xlLmxvZyhg4pyFIEJyYW5jaCBlbmNvbnRyYWRvOiAke2JyYW5jaFJlZi5zaGEuc3Vic3RyaW5nKDAsIDcpfWApO1xuXG4gICAgICAvLyAyLiBPYnRlciDDoXJ2b3JlIGF0dWFsXG4gICAgICBjb25zdCBjdXJyZW50VHJlZSA9IGF3YWl0IHRoaXMuZ2V0Q29tbWl0VHJlZShvd25lciwgcmVwbywgYnJhbmNoUmVmLnNoYSk7XG4gICAgICBjb25zb2xlLmxvZyhg4pyFIMOBcnZvcmUgb2J0aWRhOiAke2N1cnJlbnRUcmVlLnRyZWUuc2hhLnN1YnN0cmluZygwLCA3KX1gKTtcblxuICAgICAgLy8gMy4gQ3JpYXIgbm92YSDDoXJ2b3JlIGNvbSBvcyBhcnF1aXZvc1xuICAgICAgY29uc3QgbmV3VHJlZSA9IGF3YWl0IHRoaXMuY3JlYXRlVHJlZShvd25lciwgcmVwbywgZmlsZXMsIGN1cnJlbnRUcmVlLnRyZWUuc2hhKTtcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgTm92YSDDoXJ2b3JlIGNyaWFkYTogJHtuZXdUcmVlLnNoYS5zdWJzdHJpbmcoMCwgNyl9YCk7XG5cbiAgICAgIC8vIDQuIENyaWFyIG5vdm8gY29tbWl0XG4gICAgICBjb25zdCBuZXdDb21taXQgPSBhd2FpdCB0aGlzLmNyZWF0ZUNvbW1pdChcbiAgICAgICAgb3duZXIsXG4gICAgICAgIHJlcG8sXG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIG5ld1RyZWUuc2hhLFxuICAgICAgICBicmFuY2hSZWYuc2hhLFxuICAgICAgICBhdXRob3JcbiAgICAgICk7XG4gICAgICBjb25zb2xlLmxvZyhg4pyFIENvbW1pdCBjcmlhZG86ICR7bmV3Q29tbWl0LnNoYS5zdWJzdHJpbmcoMCwgNyl9YCk7XG5cbiAgICAgIC8vIDUuIEZhemVyIHB1c2ggKGF0dWFsaXphciByZWZlcsOqbmNpYSlcbiAgICAgIGNvbnN0IHB1c2ggPSBhd2FpdCB0aGlzLnVwZGF0ZVJlZihvd25lciwgcmVwbywgYnJhbmNoLCBuZXdDb21taXQuc2hhKTtcbiAgICAgIGNvbnNvbGUubG9nKGDinIUgUHVzaCByZWFsaXphZG8gY29tIHN1Y2Vzc28hYCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGNvbW1pdDogbmV3Q29tbWl0LFxuICAgICAgICBicmFuY2g6IHB1c2guYnJhbmNoLFxuICAgICAgICBmaWxlc0NoYW5nZWQ6IGZpbGVzLmxlbmd0aCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBFcnJvIG5vIGNvbW1pdC9wdXNoOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JpYXIgUHVsbCBSZXF1ZXN0XG4gICAqL1xuICBhc3luYyBjcmVhdGVQdWxsUmVxdWVzdChvd25lciwgcmVwbywgdGl0bGUsIGJvZHksIGhlYWQsIGJhc2UgPSBcIm1haW5cIikge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9wdWxsc2AsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgYm9keSxcbiAgICAgICAgICBoZWFkLFxuICAgICAgICAgIGJhc2UsXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZXJyb3IgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBjcmlhciBQUjogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBudW1iZXI6IGRhdGEubnVtYmVyLFxuICAgICAgICB0aXRsZTogZGF0YS50aXRsZSxcbiAgICAgICAgdXJsOiBkYXRhLmh0bWxfdXJsLFxuICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdGUsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gY3JpYXIgUFI6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTGlzdGFyIGFycXVpdm9zIG1vZGlmaWNhZG9zIGVtIHVtIGNvbW1pdFxuICAgKi9cbiAgYXN5bmMgZ2V0Q29tbWl0RmlsZXMob3duZXIsIHJlcG8sIGNvbW1pdFNoYSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9jb21taXRzLyR7Y29tbWl0U2hhfWAsIHtcbiAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb21taXQgbsOjbyBlbmNvbnRyYWRvOiAke2NvbW1pdFNoYX1gKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29tbWl0OiBjb21taXRTaGEsXG4gICAgICAgIGF1dGhvcjogZGF0YS5jb21taXQuYXV0aG9yLFxuICAgICAgICBtZXNzYWdlOiBkYXRhLmNvbW1pdC5tZXNzYWdlLFxuICAgICAgICBmaWxlczogZGF0YS5maWxlcy5tYXAoKGYpID0+ICh7XG4gICAgICAgICAgcGF0aDogZi5maWxlbmFtZSxcbiAgICAgICAgICBzdGF0dXM6IGYuc3RhdHVzLFxuICAgICAgICAgIGFkZGl0aW9uczogZi5hZGRpdGlvbnMsXG4gICAgICAgICAgZGVsZXRpb25zOiBmLmRlbGV0aW9ucyxcbiAgICAgICAgICBjaGFuZ2VzOiBmLmNoYW5nZXMsXG4gICAgICAgIH0pKSxcbiAgICAgICAgc3RhdHM6IHtcbiAgICAgICAgICB0b3RhbDogZGF0YS5maWxlcy5sZW5ndGgsXG4gICAgICAgICAgYWRkaXRpb25zOiBkYXRhLnN0YXRzLmFkZGl0aW9ucyxcbiAgICAgICAgICBkZWxldGlvbnM6IGRhdGEuc3RhdHMuZGVsZXRpb25zLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGFycXVpdm9zOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9idGVyIGNvbnRlw7pkbyBkZSBhcnF1aXZvXG4gICAqL1xuICBhc3luYyBnZXRGaWxlQ29udGVudChvd25lciwgcmVwbywgcGF0aCwgYnJhbmNoID0gXCJtYWluXCIpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7dGhpcy5iYXNlVXJsfS9yZXBvcy8ke293bmVyfS8ke3JlcG99L2NvbnRlbnRzLyR7cGF0aH0/cmVmPSR7YnJhbmNofWAsXG4gICAgICAgIHsgaGVhZGVyczogdGhpcy5oZWFkZXJzIH1cbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBcnF1aXZvIG7Do28gZW5jb250cmFkbzogJHtwYXRofWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICAvLyBEZWNvZGlmaWNhciBiYXNlNjRcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBCdWZmZXIuZnJvbShkYXRhLmNvbnRlbnQsIFwiYmFzZTY0XCIpLnRvU3RyaW5nKFwidXRmLThcIik7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhdGg6IGRhdGEucGF0aCxcbiAgICAgICAgY29udGVudCxcbiAgICAgICAgc2hhOiBkYXRhLnNoYSxcbiAgICAgICAgc2l6ZTogZGF0YS5zaXplLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGFycXVpdm86ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JpYXIgYnJhbmNoXG4gICAqL1xuICBhc3luYyBjcmVhdGVCcmFuY2gob3duZXIsIHJlcG8sIGJyYW5jaE5hbWUsIGZyb21CcmFuY2ggPSBcIm1haW5cIikge1xuICAgIHRyeSB7XG4gICAgICAvLyBPYnRlciBTSEEgZG8gYnJhbmNoIG9yaWdlbVxuICAgICAgY29uc3Qgb3JpZ2luQnJhbmNoID0gYXdhaXQgdGhpcy5nZXRCcmFuY2hSZWYob3duZXIsIHJlcG8sIGZyb21CcmFuY2gpO1xuXG4gICAgICAvLyBDcmlhciBub3ZvIGJyYW5jaFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3JlcG9zLyR7b3duZXJ9LyR7cmVwb30vZ2l0L3JlZnNgLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIHJlZjogYHJlZnMvaGVhZHMvJHticmFuY2hOYW1lfWAsXG4gICAgICAgICAgc2hhOiBvcmlnaW5CcmFuY2guc2hhLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBjcmlhciBicmFuY2g6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBicmFuY2g6IGJyYW5jaE5hbWUsXG4gICAgICAgIHNoYTogZGF0YS5vYmplY3Quc2hhLFxuICAgICAgICBjcmVhdGVkOiB0cnVlLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGNyaWFyIGJyYW5jaDogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGFyIGJyYW5jaFxuICAgKi9cbiAgYXN5bmMgZGVsZXRlQnJhbmNoKG93bmVyLCByZXBvLCBicmFuY2hOYW1lKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgIGAke3RoaXMuYmFzZVVybH0vcmVwb3MvJHtvd25lcn0vJHtyZXBvfS9naXQvcmVmcy9oZWFkcy8ke2JyYW5jaE5hbWV9YCxcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICAgIH1cbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGRlbGV0YXIgYnJhbmNoOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYnJhbmNoOiBicmFuY2hOYW1lLFxuICAgICAgICBkZWxldGVkOiB0cnVlLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIGRlbGV0YXIgYnJhbmNoOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9idGVyIGhpc3TDs3JpY28gZGUgY29tbWl0c1xuICAgKi9cbiAgYXN5bmMgZ2V0Q29tbWl0SGlzdG9yeShvd25lciwgcmVwbywgYnJhbmNoID0gXCJtYWluXCIsIGxpbWl0ID0gMTApIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYCR7dGhpcy5iYXNlVXJsfS9yZXBvcy8ke293bmVyfS8ke3JlcG99L2NvbW1pdHM/c2hhPSR7YnJhbmNofSZwZXJfcGFnZT0ke2xpbWl0fWAsXG4gICAgICAgIHsgaGVhZGVyczogdGhpcy5oZWFkZXJzIH1cbiAgICAgICk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIGFvIG9idGVyIGhpc3TDs3JpY286ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICByZXR1cm4gZGF0YS5tYXAoKGNvbW1pdCkgPT4gKHtcbiAgICAgICAgc2hhOiBjb21taXQuc2hhLFxuICAgICAgICBtZXNzYWdlOiBjb21taXQuY29tbWl0Lm1lc3NhZ2UsXG4gICAgICAgIGF1dGhvcjogY29tbWl0LmNvbW1pdC5hdXRob3IubmFtZSxcbiAgICAgICAgZGF0ZTogY29tbWl0LmNvbW1pdC5hdXRob3IuZGF0ZSxcbiAgICAgICAgdXJsOiBjb21taXQuaHRtbF91cmwsXG4gICAgICB9KSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBvYnRlciBoaXN0w7NyaWNvOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG59XG5cbi8vIEV4cG9ydGFyXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUuZXhwb3J0cykge1xuICBtb2R1bGUuZXhwb3J0cyA9IEdpdEh1YkF1dG9tYXRpb247XG59XG5cbmV4cG9ydCBkZWZhdWx0IEdpdEh1YkF1dG9tYXRpb247XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsZ0JB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