565cf35cb4831b6803b2931cbee541d2
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
/**
 * SECURITY VALIDATOR
 * Validação rigorosa de código antes de commits automáticos
 * Previne: Malware, credenciais expostas, deletar arquivos críticos, etc
 */

class SecurityValidator {
  constructor() {
    this.blockedPatterns = {
      // Comandos perigosos
      destructive: [/rm\s+-rf\s+\//, /rm\s+-rf\s+\*/, /del\s+\/s\s+\/q/, /DROP\s+TABLE/i, /DELETE\s+FROM/i, /TRUNCATE\s+TABLE/i],
      // Credenciais expostas
      credentials: [/process\.env\.[A-Z_]+/, /GITHUB_TOKEN/, /API_KEY/, /SECRET_KEY/, /PASSWORD/, /aws_secret_access_key/i, /private_key/i, /bearer\s+[a-z0-9]{40,}/i],
      // Código malicioso
      malicious: [/eval\s*\(/, /Function\s*\(/, /exec\s*\(/, /spawn\s*\(/, /require\s*\(\s*['"]child_process['"]\s*\)/, /import\s+.*\s+from\s+['"]child_process['"]/, /\.shell\s*\(/, /\.exec\s*\(/],
      // Acesso a arquivos críticos
      criticalFiles: [/\.git\//, /\.env/, /node_modules\//, /\.github\/workflows/, /vercel\.json/, /package-lock\.json/, /yarn\.lock/],
      // Modificações perigosas
      dangerousModifications: [/delete\s+.*\.git/i, /remove\s+.*package\.json/i, /truncate\s+.*database/i]
    };
    this.criticalFiles = [".git", ".github", "node_modules", ".env", ".env.production", ".env.local", "package-lock.json", "yarn.lock", "vercel.json", "firebase.json"];
    this.allowedExtensions = [".js", ".jsx", ".ts", ".tsx", ".json", ".css", ".scss", ".html", ".md", ".py", ".go", ".java", ".rb", ".php", ".sql", ".yml", ".yaml"];
  }

  /**
   * Validação completa de código
   */
  async validateCode(code, filePath) {
    const results = {
      isValid: true,
      errors: [],
      warnings: [],
      severity: "none",
      // none, low, medium, high, critical
      details: {
        codeLength: code.length,
        filePath,
        timestamp: new Date().toISOString()
      }
    };

    // 1. Verificar extensão do arquivo
    if (!this.isAllowedExtension(filePath)) {
      results.isValid = false;
      results.severity = "critical";
      results.errors.push({
        type: "INVALID_FILE_EXTENSION",
        message: `Extensão de arquivo não permitida: ${filePath}`,
        severity: "critical"
      });
      return results;
    }

    // 2. Verificar se é arquivo crítico
    if (this.isCriticalFile(filePath)) {
      results.isValid = false;
      results.severity = "critical";
      results.errors.push({
        type: "CRITICAL_FILE_MODIFICATION",
        message: `Não é permitido modificar arquivo crítico: ${filePath}`,
        severity: "critical"
      });
      return results;
    }

    // 3. Verificar padrões bloqueados
    const patternCheck = this.checkBlockedPatterns(code);
    if (patternCheck.found.length > 0) {
      results.isValid = false;
      results.severity = "critical";
      results.errors.push({
        type: "BLOCKED_PATTERN_DETECTED",
        message: `Padrões perigosos detectados: ${patternCheck.found.join(", ")}`,
        severity: "critical",
        patterns: patternCheck.details
      });
      return results;
    }

    // 4. Verificar credenciais expostas
    const credentialCheck = this.checkCredentials(code);
    if (credentialCheck.found.length > 0) {
      results.isValid = false;
      results.severity = "critical";
      results.errors.push({
        type: "CREDENTIALS_EXPOSED",
        message: `Credenciais potencialmente expostas: ${credentialCheck.found.join(", ")}`,
        severity: "critical",
        credentials: credentialCheck.details
      });
      return results;
    }

    // 5. Verificar sintaxe básica
    const syntaxCheck = this.checkSyntax(code, filePath);
    if (!syntaxCheck.isValid) {
      results.warnings.push({
        type: "SYNTAX_WARNING",
        message: syntaxCheck.message,
        severity: "medium"
      });
    }

    // 6. Verificar tamanho do arquivo
    if (code.length > 1000000) {
      results.warnings.push({
        type: "FILE_TOO_LARGE",
        message: `Arquivo muito grande (${code.length} bytes)`,
        severity: "low"
      });
    }

    // 7. Verificar padrões de boas práticas
    const bestPracticesCheck = this.checkBestPractices(code, filePath);
    results.warnings.push(...bestPracticesCheck);
    return results;
  }

  /**
   * Validar múltiplos arquivos
   */
  async validateFiles(files) {
    const results = {
      totalFiles: files.length,
      validFiles: 0,
      invalidFiles: 0,
      warnings: 0,
      details: [],
      isValid: true
    };
    for (const file of files) {
      const validation = await this.validateCode(file.content, file.path);
      results.details.push({
        path: file.path,
        ...validation
      });
      if (!validation.isValid) {
        results.invalidFiles++;
        results.isValid = false;
      } else {
        results.validFiles++;
      }
      if (validation.warnings.length > 0) {
        results.warnings += validation.warnings.length;
      }
    }
    return results;
  }

  /**
   * Verificar extensão permitida
   */
  isAllowedExtension(filePath) {
    const ext = filePath.substring(filePath.lastIndexOf("."));
    return this.allowedExtensions.includes(ext.toLowerCase());
  }

  /**
   * Verificar se é arquivo crítico
   */
  isCriticalFile(filePath) {
    return this.criticalFiles.some(critical => filePath.includes(critical) || filePath.startsWith(critical));
  }

  /**
   * Verificar padrões bloqueados
   */
  checkBlockedPatterns(code) {
    const found = [];
    const details = [];
    for (const [category, patterns] of Object.entries(this.blockedPatterns)) {
      for (const pattern of patterns) {
        const matches = code.match(pattern);
        if (matches) {
          found.push(category);
          details.push({
            category,
            pattern: pattern.toString(),
            matches: matches.slice(0, 3) // Primeiras 3 ocorrências
          });
        }
      }
    }
    return {
      found: [...new Set(found)],
      details
    };
  }

  /**
   * Verificar credenciais expostas
   */
  checkCredentials(code) {
    const found = [];
    const details = [];
    for (const pattern of this.blockedPatterns.credentials) {
      const matches = code.match(new RegExp(pattern, "g"));
      if (matches) {
        found.push(...matches);
        details.push({
          pattern: pattern.toString(),
          count: matches.length
        });
      }
    }
    return {
      found: [...new Set(found)],
      details,
      riskLevel: found.length > 0 ? "CRITICAL" : "SAFE"
    };
  }

  /**
   * Verificar sintaxe básica
   */
  checkSyntax(code, filePath) {
    const ext = filePath.substring(filePath.lastIndexOf("."));

    // Verificações básicas por tipo de arquivo
    if ([".js", ".jsx", ".ts", ".tsx"].includes(ext)) {
      // Verificar chaves balanceadas
      const openBraces = (code.match(/{/g) || []).length;
      const closeBraces = (code.match(/}/g) || []).length;
      if (openBraces !== closeBraces) {
        return {
          isValid: false,
          message: `Chaves desbalanceadas: ${openBraces} abertas, ${closeBraces} fechadas`
        };
      }

      // Verificar parênteses balanceados
      const openParens = (code.match(/\(/g) || []).length;
      const closeParens = (code.match(/\)/g) || []).length;
      if (openParens !== closeParens) {
        return {
          isValid: false,
          message: `Parênteses desbalanceados: ${openParens} abertos, ${closeParens} fechados`
        };
      }
    }
    if ([".json"].includes(ext)) {
      try {
        JSON.parse(code);
      } catch (error) {
        return {
          isValid: false,
          message: `JSON inválido: ${error.message}`
        };
      }
    }
    return {
      isValid: true
    };
  }

  /**
   * Verificar boas práticas
   */
  checkBestPractices(code, filePath) {
    const warnings = [];

    // Verificar console.log em produção
    if (code.includes("console.log") && !filePath.includes("test")) {
      warnings.push({
        type: "CONSOLE_LOG_IN_PRODUCTION",
        message: "console.log detectado em código de produção",
        severity: "low",
        suggestion: "Use logger apropriado em vez de console.log"
      });
    }

    // Verificar TODO/FIXME
    if (code.includes("TODO") || code.includes("FIXME")) {
      warnings.push({
        type: "UNFINISHED_CODE",
        message: "Código com TODO/FIXME detectado",
        severity: "low",
        suggestion: "Remova comentários TODO/FIXME antes de fazer commit"
      });
    }

    // Verificar comentários de debug
    if (code.includes("debugger")) {
      warnings.push({
        type: "DEBUG_STATEMENT",
        message: "Declaração debugger detectada",
        severity: "medium",
        suggestion: "Remova debugger antes de fazer commit"
      });
    }
    return warnings;
  }

  /**
   * Gerar relatório de segurança
   */
  generateSecurityReport(validationResults) {
    return {
      timestamp: new Date().toISOString(),
      summary: {
        totalChecks: validationResults.details.length,
        passed: validationResults.validFiles,
        failed: validationResults.invalidFiles,
        warnings: validationResults.warnings,
        overallStatus: validationResults.isValid ? "SAFE" : "BLOCKED"
      },
      details: validationResults.details,
      recommendation: validationResults.isValid ? "✅ Código aprovado para commit" : "❌ Código bloqueado - Corrija os erros antes de fazer commit"
    };
  }
}

// Exportar
if (typeof module !== "undefined" && module.exports) {
  module.exports = SecurityValidator;
}
var _default = exports.default = SecurityValidator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTZWN1cml0eVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiYmxvY2tlZFBhdHRlcm5zIiwiZGVzdHJ1Y3RpdmUiLCJjcmVkZW50aWFscyIsIm1hbGljaW91cyIsImNyaXRpY2FsRmlsZXMiLCJkYW5nZXJvdXNNb2RpZmljYXRpb25zIiwiYWxsb3dlZEV4dGVuc2lvbnMiLCJ2YWxpZGF0ZUNvZGUiLCJjb2RlIiwiZmlsZVBhdGgiLCJyZXN1bHRzIiwiaXNWYWxpZCIsImVycm9ycyIsIndhcm5pbmdzIiwic2V2ZXJpdHkiLCJkZXRhaWxzIiwiY29kZUxlbmd0aCIsImxlbmd0aCIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImlzQWxsb3dlZEV4dGVuc2lvbiIsInB1c2giLCJ0eXBlIiwibWVzc2FnZSIsImlzQ3JpdGljYWxGaWxlIiwicGF0dGVybkNoZWNrIiwiY2hlY2tCbG9ja2VkUGF0dGVybnMiLCJmb3VuZCIsImpvaW4iLCJwYXR0ZXJucyIsImNyZWRlbnRpYWxDaGVjayIsImNoZWNrQ3JlZGVudGlhbHMiLCJzeW50YXhDaGVjayIsImNoZWNrU3ludGF4IiwiYmVzdFByYWN0aWNlc0NoZWNrIiwiY2hlY2tCZXN0UHJhY3RpY2VzIiwidmFsaWRhdGVGaWxlcyIsImZpbGVzIiwidG90YWxGaWxlcyIsInZhbGlkRmlsZXMiLCJpbnZhbGlkRmlsZXMiLCJmaWxlIiwidmFsaWRhdGlvbiIsImNvbnRlbnQiLCJwYXRoIiwiZXh0Iiwic3Vic3RyaW5nIiwibGFzdEluZGV4T2YiLCJpbmNsdWRlcyIsInRvTG93ZXJDYXNlIiwic29tZSIsImNyaXRpY2FsIiwic3RhcnRzV2l0aCIsImNhdGVnb3J5IiwiT2JqZWN0IiwiZW50cmllcyIsInBhdHRlcm4iLCJtYXRjaGVzIiwibWF0Y2giLCJ0b1N0cmluZyIsInNsaWNlIiwiU2V0IiwiUmVnRXhwIiwiY291bnQiLCJyaXNrTGV2ZWwiLCJvcGVuQnJhY2VzIiwiY2xvc2VCcmFjZXMiLCJvcGVuUGFyZW5zIiwiY2xvc2VQYXJlbnMiLCJKU09OIiwicGFyc2UiLCJlcnJvciIsInN1Z2dlc3Rpb24iLCJnZW5lcmF0ZVNlY3VyaXR5UmVwb3J0IiwidmFsaWRhdGlvblJlc3VsdHMiLCJzdW1tYXJ5IiwidG90YWxDaGVja3MiLCJwYXNzZWQiLCJmYWlsZWQiLCJvdmVyYWxsU3RhdHVzIiwicmVjb21tZW5kYXRpb24iLCJtb2R1bGUiLCJleHBvcnRzIiwiX2RlZmF1bHQiLCJkZWZhdWx0Il0sInNvdXJjZXMiOlsiU2VjdXJpdHlWYWxpZGF0b3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTRUNVUklUWSBWQUxJREFUT1JcbiAqIFZhbGlkYcOnw6NvIHJpZ29yb3NhIGRlIGPDs2RpZ28gYW50ZXMgZGUgY29tbWl0cyBhdXRvbcOhdGljb3NcbiAqIFByZXZpbmU6IE1hbHdhcmUsIGNyZWRlbmNpYWlzIGV4cG9zdGFzLCBkZWxldGFyIGFycXVpdm9zIGNyw610aWNvcywgZXRjXG4gKi9cblxuY2xhc3MgU2VjdXJpdHlWYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmJsb2NrZWRQYXR0ZXJucyA9IHtcbiAgICAgIC8vIENvbWFuZG9zIHBlcmlnb3Nvc1xuICAgICAgZGVzdHJ1Y3RpdmU6IFtcbiAgICAgICAgL3JtXFxzKy1yZlxccytcXC8vLFxuICAgICAgICAvcm1cXHMrLXJmXFxzK1xcKi8sXG4gICAgICAgIC9kZWxcXHMrXFwvc1xccytcXC9xLyxcbiAgICAgICAgL0RST1BcXHMrVEFCTEUvaSxcbiAgICAgICAgL0RFTEVURVxccytGUk9NL2ksXG4gICAgICAgIC9UUlVOQ0FURVxccytUQUJMRS9pLFxuICAgICAgXSxcblxuICAgICAgLy8gQ3JlZGVuY2lhaXMgZXhwb3N0YXNcbiAgICAgIGNyZWRlbnRpYWxzOiBbXG4gICAgICAgIC9wcm9jZXNzXFwuZW52XFwuW0EtWl9dKy8sXG4gICAgICAgIC9HSVRIVUJfVE9LRU4vLFxuICAgICAgICAvQVBJX0tFWS8sXG4gICAgICAgIC9TRUNSRVRfS0VZLyxcbiAgICAgICAgL1BBU1NXT1JELyxcbiAgICAgICAgL2F3c19zZWNyZXRfYWNjZXNzX2tleS9pLFxuICAgICAgICAvcHJpdmF0ZV9rZXkvaSxcbiAgICAgICAgL2JlYXJlclxccytbYS16MC05XXs0MCx9L2ksXG4gICAgICBdLFxuXG4gICAgICAvLyBDw7NkaWdvIG1hbGljaW9zb1xuICAgICAgbWFsaWNpb3VzOiBbXG4gICAgICAgIC9ldmFsXFxzKlxcKC8sXG4gICAgICAgIC9GdW5jdGlvblxccypcXCgvLFxuICAgICAgICAvZXhlY1xccypcXCgvLFxuICAgICAgICAvc3Bhd25cXHMqXFwoLyxcbiAgICAgICAgL3JlcXVpcmVcXHMqXFwoXFxzKlsnXCJdY2hpbGRfcHJvY2Vzc1snXCJdXFxzKlxcKS8sXG4gICAgICAgIC9pbXBvcnRcXHMrLipcXHMrZnJvbVxccytbJ1wiXWNoaWxkX3Byb2Nlc3NbJ1wiXS8sXG4gICAgICAgIC9cXC5zaGVsbFxccypcXCgvLFxuICAgICAgICAvXFwuZXhlY1xccypcXCgvLFxuICAgICAgXSxcblxuICAgICAgLy8gQWNlc3NvIGEgYXJxdWl2b3MgY3LDrXRpY29zXG4gICAgICBjcml0aWNhbEZpbGVzOiBbXG4gICAgICAgIC9cXC5naXRcXC8vLFxuICAgICAgICAvXFwuZW52LyxcbiAgICAgICAgL25vZGVfbW9kdWxlc1xcLy8sXG4gICAgICAgIC9cXC5naXRodWJcXC93b3JrZmxvd3MvLFxuICAgICAgICAvdmVyY2VsXFwuanNvbi8sXG4gICAgICAgIC9wYWNrYWdlLWxvY2tcXC5qc29uLyxcbiAgICAgICAgL3lhcm5cXC5sb2NrLyxcbiAgICAgIF0sXG5cbiAgICAgIC8vIE1vZGlmaWNhw6fDtWVzIHBlcmlnb3Nhc1xuICAgICAgZGFuZ2Vyb3VzTW9kaWZpY2F0aW9uczogW1xuICAgICAgICAvZGVsZXRlXFxzKy4qXFwuZ2l0L2ksXG4gICAgICAgIC9yZW1vdmVcXHMrLipwYWNrYWdlXFwuanNvbi9pLFxuICAgICAgICAvdHJ1bmNhdGVcXHMrLipkYXRhYmFzZS9pLFxuICAgICAgXSxcbiAgICB9O1xuXG4gICAgdGhpcy5jcml0aWNhbEZpbGVzID0gW1xuICAgICAgXCIuZ2l0XCIsXG4gICAgICBcIi5naXRodWJcIixcbiAgICAgIFwibm9kZV9tb2R1bGVzXCIsXG4gICAgICBcIi5lbnZcIixcbiAgICAgIFwiLmVudi5wcm9kdWN0aW9uXCIsXG4gICAgICBcIi5lbnYubG9jYWxcIixcbiAgICAgIFwicGFja2FnZS1sb2NrLmpzb25cIixcbiAgICAgIFwieWFybi5sb2NrXCIsXG4gICAgICBcInZlcmNlbC5qc29uXCIsXG4gICAgICBcImZpcmViYXNlLmpzb25cIixcbiAgICBdO1xuXG4gICAgdGhpcy5hbGxvd2VkRXh0ZW5zaW9ucyA9IFtcbiAgICAgIFwiLmpzXCIsXG4gICAgICBcIi5qc3hcIixcbiAgICAgIFwiLnRzXCIsXG4gICAgICBcIi50c3hcIixcbiAgICAgIFwiLmpzb25cIixcbiAgICAgIFwiLmNzc1wiLFxuICAgICAgXCIuc2Nzc1wiLFxuICAgICAgXCIuaHRtbFwiLFxuICAgICAgXCIubWRcIixcbiAgICAgIFwiLnB5XCIsXG4gICAgICBcIi5nb1wiLFxuICAgICAgXCIuamF2YVwiLFxuICAgICAgXCIucmJcIixcbiAgICAgIFwiLnBocFwiLFxuICAgICAgXCIuc3FsXCIsXG4gICAgICBcIi55bWxcIixcbiAgICAgIFwiLnlhbWxcIixcbiAgICBdO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYcOnw6NvIGNvbXBsZXRhIGRlIGPDs2RpZ29cbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlQ29kZShjb2RlLCBmaWxlUGF0aCkge1xuICAgIGNvbnN0IHJlc3VsdHMgPSB7XG4gICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgZXJyb3JzOiBbXSxcbiAgICAgIHdhcm5pbmdzOiBbXSxcbiAgICAgIHNldmVyaXR5OiBcIm5vbmVcIiwgLy8gbm9uZSwgbG93LCBtZWRpdW0sIGhpZ2gsIGNyaXRpY2FsXG4gICAgICBkZXRhaWxzOiB7XG4gICAgICAgIGNvZGVMZW5ndGg6IGNvZGUubGVuZ3RoLFxuICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9LFxuICAgIH07XG5cbiAgICAvLyAxLiBWZXJpZmljYXIgZXh0ZW5zw6NvIGRvIGFycXVpdm9cbiAgICBpZiAoIXRoaXMuaXNBbGxvd2VkRXh0ZW5zaW9uKGZpbGVQYXRoKSkge1xuICAgICAgcmVzdWx0cy5pc1ZhbGlkID0gZmFsc2U7XG4gICAgICByZXN1bHRzLnNldmVyaXR5ID0gXCJjcml0aWNhbFwiO1xuICAgICAgcmVzdWx0cy5lcnJvcnMucHVzaCh7XG4gICAgICAgIHR5cGU6IFwiSU5WQUxJRF9GSUxFX0VYVEVOU0lPTlwiLFxuICAgICAgICBtZXNzYWdlOiBgRXh0ZW5zw6NvIGRlIGFycXVpdm8gbsOjbyBwZXJtaXRpZGE6ICR7ZmlsZVBhdGh9YCxcbiAgICAgICAgc2V2ZXJpdHk6IFwiY3JpdGljYWxcIixcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuXG4gICAgLy8gMi4gVmVyaWZpY2FyIHNlIMOpIGFycXVpdm8gY3LDrXRpY29cbiAgICBpZiAodGhpcy5pc0NyaXRpY2FsRmlsZShmaWxlUGF0aCkpIHtcbiAgICAgIHJlc3VsdHMuaXNWYWxpZCA9IGZhbHNlO1xuICAgICAgcmVzdWx0cy5zZXZlcml0eSA9IFwiY3JpdGljYWxcIjtcbiAgICAgIHJlc3VsdHMuZXJyb3JzLnB1c2goe1xuICAgICAgICB0eXBlOiBcIkNSSVRJQ0FMX0ZJTEVfTU9ESUZJQ0FUSU9OXCIsXG4gICAgICAgIG1lc3NhZ2U6IGBOw6NvIMOpIHBlcm1pdGlkbyBtb2RpZmljYXIgYXJxdWl2byBjcsOtdGljbzogJHtmaWxlUGF0aH1gLFxuICAgICAgICBzZXZlcml0eTogXCJjcml0aWNhbFwiLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG5cbiAgICAvLyAzLiBWZXJpZmljYXIgcGFkcsO1ZXMgYmxvcXVlYWRvc1xuICAgIGNvbnN0IHBhdHRlcm5DaGVjayA9IHRoaXMuY2hlY2tCbG9ja2VkUGF0dGVybnMoY29kZSk7XG4gICAgaWYgKHBhdHRlcm5DaGVjay5mb3VuZC5sZW5ndGggPiAwKSB7XG4gICAgICByZXN1bHRzLmlzVmFsaWQgPSBmYWxzZTtcbiAgICAgIHJlc3VsdHMuc2V2ZXJpdHkgPSBcImNyaXRpY2FsXCI7XG4gICAgICByZXN1bHRzLmVycm9ycy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJCTE9DS0VEX1BBVFRFUk5fREVURUNURURcIixcbiAgICAgICAgbWVzc2FnZTogYFBhZHLDtWVzIHBlcmlnb3NvcyBkZXRlY3RhZG9zOiAke3BhdHRlcm5DaGVjay5mb3VuZC5qb2luKFwiLCBcIil9YCxcbiAgICAgICAgc2V2ZXJpdHk6IFwiY3JpdGljYWxcIixcbiAgICAgICAgcGF0dGVybnM6IHBhdHRlcm5DaGVjay5kZXRhaWxzLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG5cbiAgICAvLyA0LiBWZXJpZmljYXIgY3JlZGVuY2lhaXMgZXhwb3N0YXNcbiAgICBjb25zdCBjcmVkZW50aWFsQ2hlY2sgPSB0aGlzLmNoZWNrQ3JlZGVudGlhbHMoY29kZSk7XG4gICAgaWYgKGNyZWRlbnRpYWxDaGVjay5mb3VuZC5sZW5ndGggPiAwKSB7XG4gICAgICByZXN1bHRzLmlzVmFsaWQgPSBmYWxzZTtcbiAgICAgIHJlc3VsdHMuc2V2ZXJpdHkgPSBcImNyaXRpY2FsXCI7XG4gICAgICByZXN1bHRzLmVycm9ycy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJDUkVERU5USUFMU19FWFBPU0VEXCIsXG4gICAgICAgIG1lc3NhZ2U6IGBDcmVkZW5jaWFpcyBwb3RlbmNpYWxtZW50ZSBleHBvc3RhczogJHtjcmVkZW50aWFsQ2hlY2suZm91bmQuam9pbihcIiwgXCIpfWAsXG4gICAgICAgIHNldmVyaXR5OiBcImNyaXRpY2FsXCIsXG4gICAgICAgIGNyZWRlbnRpYWxzOiBjcmVkZW50aWFsQ2hlY2suZGV0YWlscyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuXG4gICAgLy8gNS4gVmVyaWZpY2FyIHNpbnRheGUgYsOhc2ljYVxuICAgIGNvbnN0IHN5bnRheENoZWNrID0gdGhpcy5jaGVja1N5bnRheChjb2RlLCBmaWxlUGF0aCk7XG4gICAgaWYgKCFzeW50YXhDaGVjay5pc1ZhbGlkKSB7XG4gICAgICByZXN1bHRzLndhcm5pbmdzLnB1c2goe1xuICAgICAgICB0eXBlOiBcIlNZTlRBWF9XQVJOSU5HXCIsXG4gICAgICAgIG1lc3NhZ2U6IHN5bnRheENoZWNrLm1lc3NhZ2UsXG4gICAgICAgIHNldmVyaXR5OiBcIm1lZGl1bVwiLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gNi4gVmVyaWZpY2FyIHRhbWFuaG8gZG8gYXJxdWl2b1xuICAgIGlmIChjb2RlLmxlbmd0aCA+IDEwMDAwMDApIHtcbiAgICAgIHJlc3VsdHMud2FybmluZ3MucHVzaCh7XG4gICAgICAgIHR5cGU6IFwiRklMRV9UT09fTEFSR0VcIixcbiAgICAgICAgbWVzc2FnZTogYEFycXVpdm8gbXVpdG8gZ3JhbmRlICgke2NvZGUubGVuZ3RofSBieXRlcylgLFxuICAgICAgICBzZXZlcml0eTogXCJsb3dcIixcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIDcuIFZlcmlmaWNhciBwYWRyw7VlcyBkZSBib2FzIHByw6F0aWNhc1xuICAgIGNvbnN0IGJlc3RQcmFjdGljZXNDaGVjayA9IHRoaXMuY2hlY2tCZXN0UHJhY3RpY2VzKGNvZGUsIGZpbGVQYXRoKTtcbiAgICByZXN1bHRzLndhcm5pbmdzLnB1c2goLi4uYmVzdFByYWN0aWNlc0NoZWNrKTtcblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXIgbcO6bHRpcGxvcyBhcnF1aXZvc1xuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVGaWxlcyhmaWxlcykge1xuICAgIGNvbnN0IHJlc3VsdHMgPSB7XG4gICAgICB0b3RhbEZpbGVzOiBmaWxlcy5sZW5ndGgsXG4gICAgICB2YWxpZEZpbGVzOiAwLFxuICAgICAgaW52YWxpZEZpbGVzOiAwLFxuICAgICAgd2FybmluZ3M6IDAsXG4gICAgICBkZXRhaWxzOiBbXSxcbiAgICAgIGlzVmFsaWQ6IHRydWUsXG4gICAgfTtcblxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVDb2RlKGZpbGUuY29udGVudCwgZmlsZS5wYXRoKTtcblxuICAgICAgcmVzdWx0cy5kZXRhaWxzLnB1c2goe1xuICAgICAgICBwYXRoOiBmaWxlLnBhdGgsXG4gICAgICAgIC4uLnZhbGlkYXRpb24sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgICAgcmVzdWx0cy5pbnZhbGlkRmlsZXMrKztcbiAgICAgICAgcmVzdWx0cy5pc1ZhbGlkID0gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRzLnZhbGlkRmlsZXMrKztcbiAgICAgIH1cblxuICAgICAgaWYgKHZhbGlkYXRpb24ud2FybmluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICByZXN1bHRzLndhcm5pbmdzICs9IHZhbGlkYXRpb24ud2FybmluZ3MubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhciBleHRlbnPDo28gcGVybWl0aWRhXG4gICAqL1xuICBpc0FsbG93ZWRFeHRlbnNpb24oZmlsZVBhdGgpIHtcbiAgICBjb25zdCBleHQgPSBmaWxlUGF0aC5zdWJzdHJpbmcoZmlsZVBhdGgubGFzdEluZGV4T2YoXCIuXCIpKTtcbiAgICByZXR1cm4gdGhpcy5hbGxvd2VkRXh0ZW5zaW9ucy5pbmNsdWRlcyhleHQudG9Mb3dlckNhc2UoKSk7XG4gIH1cblxuICAvKipcbiAgICogVmVyaWZpY2FyIHNlIMOpIGFycXVpdm8gY3LDrXRpY29cbiAgICovXG4gIGlzQ3JpdGljYWxGaWxlKGZpbGVQYXRoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3JpdGljYWxGaWxlcy5zb21lKFxuICAgICAgKGNyaXRpY2FsKSA9PiBmaWxlUGF0aC5pbmNsdWRlcyhjcml0aWNhbCkgfHwgZmlsZVBhdGguc3RhcnRzV2l0aChjcml0aWNhbClcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhciBwYWRyw7VlcyBibG9xdWVhZG9zXG4gICAqL1xuICBjaGVja0Jsb2NrZWRQYXR0ZXJucyhjb2RlKSB7XG4gICAgY29uc3QgZm91bmQgPSBbXTtcbiAgICBjb25zdCBkZXRhaWxzID0gW107XG5cbiAgICBmb3IgKGNvbnN0IFtjYXRlZ29yeSwgcGF0dGVybnNdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuYmxvY2tlZFBhdHRlcm5zKSkge1xuICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBjb2RlLm1hdGNoKHBhdHRlcm4pO1xuICAgICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICAgIGZvdW5kLnB1c2goY2F0ZWdvcnkpO1xuICAgICAgICAgIGRldGFpbHMucHVzaCh7XG4gICAgICAgICAgICBjYXRlZ29yeSxcbiAgICAgICAgICAgIHBhdHRlcm46IHBhdHRlcm4udG9TdHJpbmcoKSxcbiAgICAgICAgICAgIG1hdGNoZXM6IG1hdGNoZXMuc2xpY2UoMCwgMyksIC8vIFByaW1laXJhcyAzIG9jb3Jyw6puY2lhc1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgZm91bmQ6IFsuLi5uZXcgU2V0KGZvdW5kKV0sIGRldGFpbHMgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBWZXJpZmljYXIgY3JlZGVuY2lhaXMgZXhwb3N0YXNcbiAgICovXG4gIGNoZWNrQ3JlZGVudGlhbHMoY29kZSkge1xuICAgIGNvbnN0IGZvdW5kID0gW107XG4gICAgY29uc3QgZGV0YWlscyA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRoaXMuYmxvY2tlZFBhdHRlcm5zLmNyZWRlbnRpYWxzKSB7XG4gICAgICBjb25zdCBtYXRjaGVzID0gY29kZS5tYXRjaChuZXcgUmVnRXhwKHBhdHRlcm4sIFwiZ1wiKSk7XG4gICAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICBmb3VuZC5wdXNoKC4uLm1hdGNoZXMpO1xuICAgICAgICBkZXRhaWxzLnB1c2goe1xuICAgICAgICAgIHBhdHRlcm46IHBhdHRlcm4udG9TdHJpbmcoKSxcbiAgICAgICAgICBjb3VudDogbWF0Y2hlcy5sZW5ndGgsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBmb3VuZDogWy4uLm5ldyBTZXQoZm91bmQpXSxcbiAgICAgIGRldGFpbHMsXG4gICAgICByaXNrTGV2ZWw6IGZvdW5kLmxlbmd0aCA+IDAgPyBcIkNSSVRJQ0FMXCIgOiBcIlNBRkVcIixcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhciBzaW50YXhlIGLDoXNpY2FcbiAgICovXG4gIGNoZWNrU3ludGF4KGNvZGUsIGZpbGVQYXRoKSB7XG4gICAgY29uc3QgZXh0ID0gZmlsZVBhdGguc3Vic3RyaW5nKGZpbGVQYXRoLmxhc3RJbmRleE9mKFwiLlwiKSk7XG5cbiAgICAvLyBWZXJpZmljYcOnw7VlcyBiw6FzaWNhcyBwb3IgdGlwbyBkZSBhcnF1aXZvXG4gICAgaWYgKFtcIi5qc1wiLCBcIi5qc3hcIiwgXCIudHNcIiwgXCIudHN4XCJdLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgIC8vIFZlcmlmaWNhciBjaGF2ZXMgYmFsYW5jZWFkYXNcbiAgICAgIGNvbnN0IG9wZW5CcmFjZXMgPSAoY29kZS5tYXRjaCgvey9nKSB8fCBbXSkubGVuZ3RoO1xuICAgICAgY29uc3QgY2xvc2VCcmFjZXMgPSAoY29kZS5tYXRjaCgvfS9nKSB8fCBbXSkubGVuZ3RoO1xuXG4gICAgICBpZiAob3BlbkJyYWNlcyAhPT0gY2xvc2VCcmFjZXMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBtZXNzYWdlOiBgQ2hhdmVzIGRlc2JhbGFuY2VhZGFzOiAke29wZW5CcmFjZXN9IGFiZXJ0YXMsICR7Y2xvc2VCcmFjZXN9IGZlY2hhZGFzYCxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gVmVyaWZpY2FyIHBhcsOqbnRlc2VzIGJhbGFuY2VhZG9zXG4gICAgICBjb25zdCBvcGVuUGFyZW5zID0gKGNvZGUubWF0Y2goL1xcKC9nKSB8fCBbXSkubGVuZ3RoO1xuICAgICAgY29uc3QgY2xvc2VQYXJlbnMgPSAoY29kZS5tYXRjaCgvXFwpL2cpIHx8IFtdKS5sZW5ndGg7XG5cbiAgICAgIGlmIChvcGVuUGFyZW5zICE9PSBjbG9zZVBhcmVucykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6IGBQYXLDqm50ZXNlcyBkZXNiYWxhbmNlYWRvczogJHtvcGVuUGFyZW5zfSBhYmVydG9zLCAke2Nsb3NlUGFyZW5zfSBmZWNoYWRvc2AsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKFtcIi5qc29uXCJdLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIEpTT04ucGFyc2UoY29kZSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlzVmFsaWQ6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6IGBKU09OIGludsOhbGlkbzogJHtlcnJvci5tZXNzYWdlfWAsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgaXNWYWxpZDogdHJ1ZSB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZlcmlmaWNhciBib2FzIHByw6F0aWNhc1xuICAgKi9cbiAgY2hlY2tCZXN0UHJhY3RpY2VzKGNvZGUsIGZpbGVQYXRoKSB7XG4gICAgY29uc3Qgd2FybmluZ3MgPSBbXTtcblxuICAgIC8vIFZlcmlmaWNhciBjb25zb2xlLmxvZyBlbSBwcm9kdcOnw6NvXG4gICAgaWYgKGNvZGUuaW5jbHVkZXMoXCJjb25zb2xlLmxvZ1wiKSAmJiAhZmlsZVBhdGguaW5jbHVkZXMoXCJ0ZXN0XCIpKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJDT05TT0xFX0xPR19JTl9QUk9EVUNUSU9OXCIsXG4gICAgICAgIG1lc3NhZ2U6IFwiY29uc29sZS5sb2cgZGV0ZWN0YWRvIGVtIGPDs2RpZ28gZGUgcHJvZHXDp8Ojb1wiLFxuICAgICAgICBzZXZlcml0eTogXCJsb3dcIixcbiAgICAgICAgc3VnZ2VzdGlvbjogXCJVc2UgbG9nZ2VyIGFwcm9wcmlhZG8gZW0gdmV6IGRlIGNvbnNvbGUubG9nXCIsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZmljYXIgVE9ETy9GSVhNRVxuICAgIGlmIChjb2RlLmluY2x1ZGVzKFwiVE9ET1wiKSB8fCBjb2RlLmluY2x1ZGVzKFwiRklYTUVcIikpIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goe1xuICAgICAgICB0eXBlOiBcIlVORklOSVNIRURfQ09ERVwiLFxuICAgICAgICBtZXNzYWdlOiBcIkPDs2RpZ28gY29tIFRPRE8vRklYTUUgZGV0ZWN0YWRvXCIsXG4gICAgICAgIHNldmVyaXR5OiBcImxvd1wiLFxuICAgICAgICBzdWdnZXN0aW9uOiBcIlJlbW92YSBjb21lbnTDoXJpb3MgVE9ETy9GSVhNRSBhbnRlcyBkZSBmYXplciBjb21taXRcIixcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFZlcmlmaWNhciBjb21lbnTDoXJpb3MgZGUgZGVidWdcbiAgICBpZiAoY29kZS5pbmNsdWRlcyhcImRlYnVnZ2VyXCIpKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKHtcbiAgICAgICAgdHlwZTogXCJERUJVR19TVEFURU1FTlRcIixcbiAgICAgICAgbWVzc2FnZTogXCJEZWNsYXJhw6fDo28gZGVidWdnZXIgZGV0ZWN0YWRhXCIsXG4gICAgICAgIHNldmVyaXR5OiBcIm1lZGl1bVwiLFxuICAgICAgICBzdWdnZXN0aW9uOiBcIlJlbW92YSBkZWJ1Z2dlciBhbnRlcyBkZSBmYXplciBjb21taXRcIixcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB3YXJuaW5ncztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXJhciByZWxhdMOzcmlvIGRlIHNlZ3VyYW7Dp2FcbiAgICovXG4gIGdlbmVyYXRlU2VjdXJpdHlSZXBvcnQodmFsaWRhdGlvblJlc3VsdHMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBzdW1tYXJ5OiB7XG4gICAgICAgIHRvdGFsQ2hlY2tzOiB2YWxpZGF0aW9uUmVzdWx0cy5kZXRhaWxzLmxlbmd0aCxcbiAgICAgICAgcGFzc2VkOiB2YWxpZGF0aW9uUmVzdWx0cy52YWxpZEZpbGVzLFxuICAgICAgICBmYWlsZWQ6IHZhbGlkYXRpb25SZXN1bHRzLmludmFsaWRGaWxlcyxcbiAgICAgICAgd2FybmluZ3M6IHZhbGlkYXRpb25SZXN1bHRzLndhcm5pbmdzLFxuICAgICAgICBvdmVyYWxsU3RhdHVzOiB2YWxpZGF0aW9uUmVzdWx0cy5pc1ZhbGlkID8gXCJTQUZFXCIgOiBcIkJMT0NLRURcIixcbiAgICAgIH0sXG4gICAgICBkZXRhaWxzOiB2YWxpZGF0aW9uUmVzdWx0cy5kZXRhaWxzLFxuICAgICAgcmVjb21tZW5kYXRpb246IHZhbGlkYXRpb25SZXN1bHRzLmlzVmFsaWRcbiAgICAgICAgPyBcIuKchSBDw7NkaWdvIGFwcm92YWRvIHBhcmEgY29tbWl0XCJcbiAgICAgICAgOiBcIuKdjCBDw7NkaWdvIGJsb3F1ZWFkbyAtIENvcnJpamEgb3MgZXJyb3MgYW50ZXMgZGUgZmF6ZXIgY29tbWl0XCIsXG4gICAgfTtcbiAgfVxufVxuXG4vLyBFeHBvcnRhclxuaWYgKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBTZWN1cml0eVZhbGlkYXRvcjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdXJpdHlWYWxpZGF0b3I7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsaUJBQWlCLENBQUM7RUFDdEJDLFdBQVdBLENBQUEsRUFBRztJQUNaLElBQUksQ0FBQ0MsZUFBZSxHQUFHO01BQ3JCO01BQ0FDLFdBQVcsRUFBRSxDQUNYLGVBQWUsRUFDZixlQUFlLEVBQ2YsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixnQkFBZ0IsRUFDaEIsbUJBQW1CLENBQ3BCO01BRUQ7TUFDQUMsV0FBVyxFQUFFLENBQ1gsdUJBQXVCLEVBQ3ZCLGNBQWMsRUFDZCxTQUFTLEVBQ1QsWUFBWSxFQUNaLFVBQVUsRUFDVix3QkFBd0IsRUFDeEIsY0FBYyxFQUNkLHlCQUF5QixDQUMxQjtNQUVEO01BQ0FDLFNBQVMsRUFBRSxDQUNULFdBQVcsRUFDWCxlQUFlLEVBQ2YsV0FBVyxFQUNYLFlBQVksRUFDWiwyQ0FBMkMsRUFDM0MsNENBQTRDLEVBQzVDLGNBQWMsRUFDZCxhQUFhLENBQ2Q7TUFFRDtNQUNBQyxhQUFhLEVBQUUsQ0FDYixTQUFTLEVBQ1QsT0FBTyxFQUNQLGdCQUFnQixFQUNoQixxQkFBcUIsRUFDckIsY0FBYyxFQUNkLG9CQUFvQixFQUNwQixZQUFZLENBQ2I7TUFFRDtNQUNBQyxzQkFBc0IsRUFBRSxDQUN0QixtQkFBbUIsRUFDbkIsMkJBQTJCLEVBQzNCLHdCQUF3QjtJQUU1QixDQUFDO0lBRUQsSUFBSSxDQUFDRCxhQUFhLEdBQUcsQ0FDbkIsTUFBTSxFQUNOLFNBQVMsRUFDVCxjQUFjLEVBQ2Qs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