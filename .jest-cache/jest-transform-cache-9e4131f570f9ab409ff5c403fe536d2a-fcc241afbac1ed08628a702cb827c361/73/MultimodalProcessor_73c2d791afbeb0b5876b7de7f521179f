05ac7c34b30fd5474078087375a96ed8
/**
 * MULTIMODAL PROCESSOR
 * Processa entrada multimodal: Voz (Speech-to-Text) e Imagem (Vision)
 * Suporta: MP3, WAV, MP4, WebM, PNG, JPG, GIF, WebP
 */

class MultimodalProcessor {
  constructor() {
    this.supportedAudioFormats = ["mp3", "wav", "mp4", "webm", "ogg", "m4a"];
    this.supportedImageFormats = ["png", "jpg", "jpeg", "gif", "webp", "bmp"];
    this.maxAudioSize = 25 * 1024 * 1024; // 25MB
    this.maxImageSize = 20 * 1024 * 1024; // 20MB
  }

  /**
   * Processar √°udio (Speech-to-Text)
   */
  async processAudio(audioBuffer, format = "mp3") {
    console.log(`üé§ Processando √°udio (${format})...`);

    // Validar formato
    if (!this.supportedAudioFormats.includes(format.toLowerCase())) {
      throw new Error(`Formato de √°udio n√£o suportado: ${format}`);
    }

    // Validar tamanho
    if (audioBuffer.length > this.maxAudioSize) {
      throw new Error(`Arquivo de √°udio muito grande: ${audioBuffer.length} bytes`);
    }
    try {
      // Chamar API de Speech-to-Text (Google Cloud Speech-to-Text)
      const transcript = await this.transcribeAudio(audioBuffer, format);
      console.log(`‚úÖ √Åudio transcrito: "${transcript.substring(0, 50)}..."`);
      return {
        type: "audio",
        format,
        transcript,
        confidence: 0.95,
        // Confian√ßa estimada
        duration: await this.estimateAudioDuration(audioBuffer, format)
      };
    } catch (error) {
      throw new Error(`Erro ao processar √°udio: ${error.message}`);
    }
  }

  /**
   * Transcrever √°udio via API
   */
  async transcribeAudio(audioBuffer, format) {
    try {
      // Converter buffer para base64
      const base64Audio = audioBuffer.toString("base64");

      // Chamar API de transcription (simulado)
      // Em produ√ß√£o, usar Google Cloud Speech-to-Text ou similar

      const response = await fetch("/api/transcribe", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          audio: base64Audio,
          format,
          language: "pt-BR"
        })
      });
      if (!response.ok) {
        throw new Error(`Erro na transcri√ß√£o: ${response.status}`);
      }
      const data = await response.json();
      return data.transcript;
    } catch (error) {
      // Fallback: retornar mensagem de erro
      throw error;
    }
  }

  /**
   * Estimar dura√ß√£o do √°udio
   */
  async estimateAudioDuration(audioBuffer, format) {
    // Estimativa simples baseada no tamanho
    // Em produ√ß√£o, usar biblioteca de √°udio
    const bitrate = 128; // kbps
    const durationSeconds = audioBuffer.length * 8 / (bitrate * 1000);
    return Math.round(durationSeconds);
  }

  /**
   * Processar imagem (Vision)
   */
  async processImage(imageBuffer, format = "png") {
    console.log(`üì∏ Processando imagem (${format})...`);

    // Validar formato
    if (!this.supportedImageFormats.includes(format.toLowerCase())) {
      throw new Error(`Formato de imagem n√£o suportado: ${format}`);
    }

    // Validar tamanho
    if (imageBuffer.length > this.maxImageSize) {
      throw new Error(`Arquivo de imagem muito grande: ${imageBuffer.length} bytes`);
    }
    try {
      // Analisar imagem
      const analysis = await this.analyzeImage(imageBuffer, format);
      console.log(`‚úÖ Imagem analisada: ${analysis.description}`);
      return {
        type: "image",
        format,
        analysis,
        size: imageBuffer.length
      };
    } catch (error) {
      throw new Error(`Erro ao processar imagem: ${error.message}`);
    }
  }

  /**
   * Analisar imagem via API
   */
  async analyzeImage(imageBuffer, format) {
    try {
      // Converter buffer para base64
      const base64Image = imageBuffer.toString("base64");

      // Chamar API de Vision (simulado)
      // Em produ√ß√£o, usar Google Cloud Vision ou similar

      const response = await fetch("/api/vision-analyze", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          image: base64Image,
          format,
          features: ["LABEL_DETECTION", "TEXT_DETECTION", "OBJECT_LOCALIZATION", "SAFE_SEARCH_DETECTION"]
        })
      });
      if (!response.ok) {
        throw new Error(`Erro na an√°lise: ${response.status}`);
      }
      const data = await response.json();
      return data.analysis;
    } catch (error) {
      throw error;
    }
  }

  /**
   * Processar entrada multimodal (√°udio + imagem)
   */
  async processMultimodal(inputs) {
    console.log(`üé¨ Processando entrada multimodal...`);
    const results = {
      audio: null,
      image: null,
      combined: null
    };

    // Processar √°udio se fornecido
    if (inputs.audio) {
      results.audio = await this.processAudio(inputs.audio.buffer, inputs.audio.format);
    }

    // Processar imagem se fornecida
    if (inputs.image) {
      results.image = await this.processImage(inputs.image.buffer, inputs.image.format);
    }

    // Combinar resultados
    if (results.audio && results.image) {
      results.combined = this.combineResults(results.audio, results.image);
    }
    return results;
  }

  /**
   * Combinar resultados de √°udio e imagem
   */
  combineResults(audioResult, imageResult) {
    return {
      transcript: audioResult.transcript,
      imageAnalysis: imageResult.analysis,
      combinedContext: `√Åudio: "${audioResult.transcript}"\n\nImagem: ${imageResult.analysis.description}`,
      confidence: {
        audio: audioResult.confidence,
        image: imageResult.analysis.confidence || 0.9
      }
    };
  }

  /**
   * Extrair texto de imagem (OCR)
   */
  async extractTextFromImage(imageBuffer, format = "png") {
    console.log(`üìÑ Extraindo texto da imagem...`);
    const analysis = await this.analyzeImage(imageBuffer, format);
    if (analysis.textDetection && analysis.textDetection.length > 0) {
      const extractedText = analysis.textDetection.map(item => item.text).join("\n");
      return {
        success: true,
        text: extractedText,
        confidence: analysis.textDetection[0].confidence || 0.9
      };
    }
    return {
      success: false,
      text: "",
      message: "Nenhum texto encontrado na imagem"
    };
  }

  /**
   * Descrever imagem
   */
  async describeImage(imageBuffer, format = "png") {
    console.log(`üì∏ Descrevendo imagem...`);
    const analysis = await this.analyzeImage(imageBuffer, format);
    return {
      description: analysis.description,
      labels: analysis.labels || [],
      objects: analysis.objects || [],
      confidence: analysis.confidence || 0.9
    };
  }

  /**
   * Detectar c√≥digo em imagem
   */
  async detectCodeInImage(imageBuffer, format = "png") {
    console.log(`üíª Detectando c√≥digo na imagem...`);
    const textResult = await this.extractTextFromImage(imageBuffer, format);
    if (!textResult.success) {
      return {
        success: false,
        code: "",
        language: null
      };
    }

    // Detectar linguagem de programa√ß√£o
    const language = this.detectProgrammingLanguage(textResult.text);
    return {
      success: true,
      code: textResult.text,
      language,
      confidence: textResult.confidence
    };
  }

  /**
   * Detectar linguagem de programa√ß√£o
   */
  detectProgrammingLanguage(code) {
    const patterns = {
      javascript: /const|let|var|function|=>|async|await/,
      python: /def|import|class|if __name__|print\(/,
      java: /public class|public static|import java/,
      cpp: /#include|std::|int main/,
      csharp: /using|namespace|public class|async Task/,
      go: /package main|func|import/,
      rust: /fn |let |pub |impl /,
      sql: /SELECT|INSERT|UPDATE|DELETE|FROM|WHERE/,
      html: /<!DOCTYPE|<html|<body|<div/,
      css: /@media|\.class|#id|{.*:.*;}/
    };
    for (const [lang, pattern] of Object.entries(patterns)) {
      if (pattern.test(code)) {
        return lang;
      }
    }
    return null;
  }

  /**
   * Validar arquivo de √°udio
   */
  validateAudioFile(filename, size) {
    const ext = filename.split(".").pop().toLowerCase();
    if (!this.supportedAudioFormats.includes(ext)) {
      return {
        valid: false,
        error: `Formato n√£o suportado: ${ext}`
      };
    }
    if (size > this.maxAudioSize) {
      return {
        valid: false,
        error: `Arquivo muito grande: ${size} bytes (m√°ximo: ${this.maxAudioSize})`
      };
    }
    return {
      valid: true
    };
  }

  /**
   * Validar arquivo de imagem
   */
  validateImageFile(filename, size) {
    const ext = filename.split(".").pop().toLowerCase();
    if (!this.supportedImageFormats.includes(ext)) {
      return {
        valid: false,
        error: `Formato n√£o suportado: ${ext}`
      };
    }
    if (size > this.maxImageSize) {
      return {
        valid: false,
        error: `Arquivo muito grande: ${size} bytes (m√°ximo: ${this.maxImageSize})`
      };
    }
    return {
      valid: true
    };
  }

  /**
   * Obter informa√ß√µes de suporte
   */
  getSupportInfo() {
    return {
      audio: {
        formats: this.supportedAudioFormats,
        maxSize: this.maxAudioSize,
        features: ["Speech-to-Text", "Transcription", "Language Detection"]
      },
      image: {
        formats: this.supportedImageFormats,
        maxSize: this.maxImageSize,
        features: ["OCR", "Object Detection", "Label Detection", "Code Detection"]
      }
    };
  }
}
export default MultimodalProcessor;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNdWx0aW1vZGFsUHJvY2Vzc29yIiwiY29uc3RydWN0b3IiLCJzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMiLCJzdXBwb3J0ZWRJbWFnZUZvcm1hdHMiLCJtYXhBdWRpb1NpemUiLCJtYXhJbWFnZVNpemUiLCJwcm9jZXNzQXVkaW8iLCJhdWRpb0J1ZmZlciIsImZvcm1hdCIsImNvbnNvbGUiLCJsb2ciLCJpbmNsdWRlcyIsInRvTG93ZXJDYXNlIiwiRXJyb3IiLCJsZW5ndGgiLCJ0cmFuc2NyaXB0IiwidHJhbnNjcmliZUF1ZGlvIiwic3Vic3RyaW5nIiwidHlwZSIsImNvbmZpZGVuY2UiLCJkdXJhdGlvbiIsImVzdGltYXRlQXVkaW9EdXJhdGlvbiIsImVycm9yIiwibWVzc2FnZSIsImJhc2U2NEF1ZGlvIiwidG9TdHJpbmciLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXVkaW8iLCJsYW5ndWFnZSIsIm9rIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJiaXRyYXRlIiwiZHVyYXRpb25TZWNvbmRzIiwiTWF0aCIsInJvdW5kIiwicHJvY2Vzc0ltYWdlIiwiaW1hZ2VCdWZmZXIiLCJhbmFseXNpcyIsImFuYWx5emVJbWFnZSIsImRlc2NyaXB0aW9uIiwic2l6ZSIsImJhc2U2NEltYWdlIiwiaW1hZ2UiLCJmZWF0dXJlcyIsInByb2Nlc3NNdWx0aW1vZGFsIiwiaW5wdXRzIiwicmVzdWx0cyIsImNvbWJpbmVkIiwiYnVmZmVyIiwiY29tYmluZVJlc3VsdHMiLCJhdWRpb1Jlc3VsdCIsImltYWdlUmVzdWx0IiwiaW1hZ2VBbmFseXNpcyIsImNvbWJpbmVkQ29udGV4dCIsImV4dHJhY3RUZXh0RnJvbUltYWdlIiwidGV4dERldGVjdGlvbiIsImV4dHJhY3RlZFRleHQiLCJtYXAiLCJpdGVtIiwidGV4dCIsImpvaW4iLCJzdWNjZXNzIiwiZGVzY3JpYmVJbWFnZSIsImxhYmVscyIsIm9iamVjdHMiLCJkZXRlY3RDb2RlSW5JbWFnZSIsInRleHRSZXN1bHQiLCJjb2RlIiwiZGV0ZWN0UHJvZ3JhbW1pbmdMYW5ndWFnZSIsInBhdHRlcm5zIiwiamF2YXNjcmlwdCIsInB5dGhvbiIsImphdmEiLCJjcHAiLCJjc2hhcnAiLCJnbyIsInJ1c3QiLCJzcWwiLCJodG1sIiwiY3NzIiwibGFuZyIsInBhdHRlcm4iLCJPYmplY3QiLCJlbnRyaWVzIiwidGVzdCIsInZhbGlkYXRlQXVkaW9GaWxlIiwiZmlsZW5hbWUiLCJleHQiLCJzcGxpdCIsInBvcCIsInZhbGlkIiwidmFsaWRhdGVJbWFnZUZpbGUiLCJnZXRTdXBwb3J0SW5mbyIsImZvcm1hdHMiLCJtYXhTaXplIl0sInNvdXJjZXMiOlsiTXVsdGltb2RhbFByb2Nlc3Nvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1VTFRJTU9EQUwgUFJPQ0VTU09SXG4gKiBQcm9jZXNzYSBlbnRyYWRhIG11bHRpbW9kYWw6IFZveiAoU3BlZWNoLXRvLVRleHQpIGUgSW1hZ2VtIChWaXNpb24pXG4gKiBTdXBvcnRhOiBNUDMsIFdBViwgTVA0LCBXZWJNLCBQTkcsIEpQRywgR0lGLCBXZWJQXG4gKi9cblxuY2xhc3MgTXVsdGltb2RhbFByb2Nlc3NvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuc3VwcG9ydGVkQXVkaW9Gb3JtYXRzID0gW1wibXAzXCIsIFwid2F2XCIsIFwibXA0XCIsIFwid2VibVwiLCBcIm9nZ1wiLCBcIm00YVwiXTtcbiAgICB0aGlzLnN1cHBvcnRlZEltYWdlRm9ybWF0cyA9IFtcInBuZ1wiLCBcImpwZ1wiLCBcImpwZWdcIiwgXCJnaWZcIiwgXCJ3ZWJwXCIsIFwiYm1wXCJdO1xuICAgIHRoaXMubWF4QXVkaW9TaXplID0gMjUgKiAxMDI0ICogMTAyNDsgLy8gMjVNQlxuICAgIHRoaXMubWF4SW1hZ2VTaXplID0gMjAgKiAxMDI0ICogMTAyNDsgLy8gMjBNQlxuICB9XG5cbiAgLyoqXG4gICAqIFByb2Nlc3NhciDDoXVkaW8gKFNwZWVjaC10by1UZXh0KVxuICAgKi9cbiAgYXN5bmMgcHJvY2Vzc0F1ZGlvKGF1ZGlvQnVmZmVyLCBmb3JtYXQgPSBcIm1wM1wiKSB7XG4gICAgY29uc29sZS5sb2coYPCfjqQgUHJvY2Vzc2FuZG8gw6F1ZGlvICgke2Zvcm1hdH0pLi4uYCk7XG5cbiAgICAvLyBWYWxpZGFyIGZvcm1hdG9cbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkQXVkaW9Gb3JtYXRzLmluY2x1ZGVzKGZvcm1hdC50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGb3JtYXRvIGRlIMOhdWRpbyBuw6NvIHN1cG9ydGFkbzogJHtmb3JtYXR9YCk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhciB0YW1hbmhvXG4gICAgaWYgKGF1ZGlvQnVmZmVyLmxlbmd0aCA+IHRoaXMubWF4QXVkaW9TaXplKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFycXVpdm8gZGUgw6F1ZGlvIG11aXRvIGdyYW5kZTogJHthdWRpb0J1ZmZlci5sZW5ndGh9IGJ5dGVzYCk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENoYW1hciBBUEkgZGUgU3BlZWNoLXRvLVRleHQgKEdvb2dsZSBDbG91ZCBTcGVlY2gtdG8tVGV4dClcbiAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCB0aGlzLnRyYW5zY3JpYmVBdWRpbyhhdWRpb0J1ZmZlciwgZm9ybWF0KTtcblxuICAgICAgY29uc29sZS5sb2coYOKchSDDgXVkaW8gdHJhbnNjcml0bzogXCIke3RyYW5zY3JpcHQuc3Vic3RyaW5nKDAsIDUwKX0uLi5cImApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcImF1ZGlvXCIsXG4gICAgICAgIGZvcm1hdCxcbiAgICAgICAgdHJhbnNjcmlwdCxcbiAgICAgICAgY29uZmlkZW5jZTogMC45NSwgLy8gQ29uZmlhbsOnYSBlc3RpbWFkYVxuICAgICAgICBkdXJhdGlvbjogYXdhaXQgdGhpcy5lc3RpbWF0ZUF1ZGlvRHVyYXRpb24oYXVkaW9CdWZmZXIsIGZvcm1hdCksXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gcHJvY2Vzc2FyIMOhdWRpbzogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUcmFuc2NyZXZlciDDoXVkaW8gdmlhIEFQSVxuICAgKi9cbiAgYXN5bmMgdHJhbnNjcmliZUF1ZGlvKGF1ZGlvQnVmZmVyLCBmb3JtYXQpIHtcbiAgICB0cnkge1xuICAgICAgLy8gQ29udmVydGVyIGJ1ZmZlciBwYXJhIGJhc2U2NFxuICAgICAgY29uc3QgYmFzZTY0QXVkaW8gPSBhdWRpb0J1ZmZlci50b1N0cmluZyhcImJhc2U2NFwiKTtcblxuICAgICAgLy8gQ2hhbWFyIEFQSSBkZSB0cmFuc2NyaXB0aW9uIChzaW11bGFkbylcbiAgICAgIC8vIEVtIHByb2R1w6fDo28sIHVzYXIgR29vZ2xlIENsb3VkIFNwZWVjaC10by1UZXh0IG91IHNpbWlsYXJcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcIi9hcGkvdHJhbnNjcmliZVwiLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGF1ZGlvOiBiYXNlNjRBdWRpbyxcbiAgICAgICAgICBmb3JtYXQsXG4gICAgICAgICAgbGFuZ3VhZ2U6IFwicHQtQlJcIixcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gbmEgdHJhbnNjcmnDp8OjbzogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICByZXR1cm4gZGF0YS50cmFuc2NyaXB0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBGYWxsYmFjazogcmV0b3JuYXIgbWVuc2FnZW0gZGUgZXJyb1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVzdGltYXIgZHVyYcOnw6NvIGRvIMOhdWRpb1xuICAgKi9cbiAgYXN5bmMgZXN0aW1hdGVBdWRpb0R1cmF0aW9uKGF1ZGlvQnVmZmVyLCBmb3JtYXQpIHtcbiAgICAvLyBFc3RpbWF0aXZhIHNpbXBsZXMgYmFzZWFkYSBubyB0YW1hbmhvXG4gICAgLy8gRW0gcHJvZHXDp8OjbywgdXNhciBiaWJsaW90ZWNhIGRlIMOhdWRpb1xuICAgIGNvbnN0IGJpdHJhdGUgPSAxMjg7IC8vIGticHNcbiAgICBjb25zdCBkdXJhdGlvblNlY29uZHMgPSAoYXVkaW9CdWZmZXIubGVuZ3RoICogOCkgLyAoYml0cmF0ZSAqIDEwMDApO1xuICAgIHJldHVybiBNYXRoLnJvdW5kKGR1cmF0aW9uU2Vjb25kcyk7XG4gIH1cblxuICAvKipcbiAgICogUHJvY2Vzc2FyIGltYWdlbSAoVmlzaW9uKVxuICAgKi9cbiAgYXN5bmMgcHJvY2Vzc0ltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQgPSBcInBuZ1wiKSB7XG4gICAgY29uc29sZS5sb2coYPCfk7ggUHJvY2Vzc2FuZG8gaW1hZ2VtICgke2Zvcm1hdH0pLi4uYCk7XG5cbiAgICAvLyBWYWxpZGFyIGZvcm1hdG9cbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkSW1hZ2VGb3JtYXRzLmluY2x1ZGVzKGZvcm1hdC50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGb3JtYXRvIGRlIGltYWdlbSBuw6NvIHN1cG9ydGFkbzogJHtmb3JtYXR9YCk7XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhciB0YW1hbmhvXG4gICAgaWYgKGltYWdlQnVmZmVyLmxlbmd0aCA+IHRoaXMubWF4SW1hZ2VTaXplKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFycXVpdm8gZGUgaW1hZ2VtIG11aXRvIGdyYW5kZTogJHtpbWFnZUJ1ZmZlci5sZW5ndGh9IGJ5dGVzYCk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEFuYWxpc2FyIGltYWdlbVxuICAgICAgY29uc3QgYW5hbHlzaXMgPSBhd2FpdCB0aGlzLmFuYWx5emVJbWFnZShpbWFnZUJ1ZmZlciwgZm9ybWF0KTtcblxuICAgICAgY29uc29sZS5sb2coYOKchSBJbWFnZW0gYW5hbGlzYWRhOiAke2FuYWx5c2lzLmRlc2NyaXB0aW9ufWApO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBcImltYWdlXCIsXG4gICAgICAgIGZvcm1hdCxcbiAgICAgICAgYW5hbHlzaXMsXG4gICAgICAgIHNpemU6IGltYWdlQnVmZmVyLmxlbmd0aCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJybyBhbyBwcm9jZXNzYXIgaW1hZ2VtOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFuYWxpc2FyIGltYWdlbSB2aWEgQVBJXG4gICAqL1xuICBhc3luYyBhbmFseXplSW1hZ2UoaW1hZ2VCdWZmZXIsIGZvcm1hdCkge1xuICAgIHRyeSB7XG4gICAgICAvLyBDb252ZXJ0ZXIgYnVmZmVyIHBhcmEgYmFzZTY0XG4gICAgICBjb25zdCBiYXNlNjRJbWFnZSA9IGltYWdlQnVmZmVyLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuXG4gICAgICAvLyBDaGFtYXIgQVBJIGRlIFZpc2lvbiAoc2ltdWxhZG8pXG4gICAgICAvLyBFbSBwcm9kdcOnw6NvLCB1c2FyIEdvb2dsZSBDbG91ZCBWaXNpb24gb3Ugc2ltaWxhclxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFwiL2FwaS92aXNpb24tYW5hbHl6ZVwiLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHsgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGltYWdlOiBiYXNlNjRJbWFnZSxcbiAgICAgICAgICBmb3JtYXQsXG4gICAgICAgICAgZmVhdHVyZXM6IFtcbiAgICAgICAgICAgIFwiTEFCRUxfREVURUNUSU9OXCIsXG4gICAgICAgICAgICBcIlRFWFRfREVURUNUSU9OXCIsXG4gICAgICAgICAgICBcIk9CSkVDVF9MT0NBTElaQVRJT05cIixcbiAgICAgICAgICAgIFwiU0FGRV9TRUFSQ0hfREVURUNUSU9OXCIsXG4gICAgICAgICAgXSxcbiAgICAgICAgfSksXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gbmEgYW7DoWxpc2U6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgcmV0dXJuIGRhdGEuYW5hbHlzaXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzYXIgZW50cmFkYSBtdWx0aW1vZGFsICjDoXVkaW8gKyBpbWFnZW0pXG4gICAqL1xuICBhc3luYyBwcm9jZXNzTXVsdGltb2RhbChpbnB1dHMpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+OrCBQcm9jZXNzYW5kbyBlbnRyYWRhIG11bHRpbW9kYWwuLi5gKTtcblxuICAgIGNvbnN0IHJlc3VsdHMgPSB7XG4gICAgICBhdWRpbzogbnVsbCxcbiAgICAgIGltYWdlOiBudWxsLFxuICAgICAgY29tYmluZWQ6IG51bGwsXG4gICAgfTtcblxuICAgIC8vIFByb2Nlc3NhciDDoXVkaW8gc2UgZm9ybmVjaWRvXG4gICAgaWYgKGlucHV0cy5hdWRpbykge1xuICAgICAgcmVzdWx0cy5hdWRpbyA9IGF3YWl0IHRoaXMucHJvY2Vzc0F1ZGlvKGlucHV0cy5hdWRpby5idWZmZXIsIGlucHV0cy5hdWRpby5mb3JtYXQpO1xuICAgIH1cblxuICAgIC8vIFByb2Nlc3NhciBpbWFnZW0gc2UgZm9ybmVjaWRhXG4gICAgaWYgKGlucHV0cy5pbWFnZSkge1xuICAgICAgcmVzdWx0cy5pbWFnZSA9IGF3YWl0IHRoaXMucHJvY2Vzc0ltYWdlKGlucHV0cy5pbWFnZS5idWZmZXIsIGlucHV0cy5pbWFnZS5mb3JtYXQpO1xuICAgIH1cblxuICAgIC8vIENvbWJpbmFyIHJlc3VsdGFkb3NcbiAgICBpZiAocmVzdWx0cy5hdWRpbyAmJiByZXN1bHRzLmltYWdlKSB7XG4gICAgICByZXN1bHRzLmNvbWJpbmVkID0gdGhpcy5jb21iaW5lUmVzdWx0cyhyZXN1bHRzLmF1ZGlvLCByZXN1bHRzLmltYWdlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21iaW5hciByZXN1bHRhZG9zIGRlIMOhdWRpbyBlIGltYWdlbVxuICAgKi9cbiAgY29tYmluZVJlc3VsdHMoYXVkaW9SZXN1bHQsIGltYWdlUmVzdWx0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRyYW5zY3JpcHQ6IGF1ZGlvUmVzdWx0LnRyYW5zY3JpcHQsXG4gICAgICBpbWFnZUFuYWx5c2lzOiBpbWFnZVJlc3VsdC5hbmFseXNpcyxcbiAgICAgIGNvbWJpbmVkQ29udGV4dDogYMOBdWRpbzogXCIke2F1ZGlvUmVzdWx0LnRyYW5zY3JpcHR9XCJcXG5cXG5JbWFnZW06ICR7aW1hZ2VSZXN1bHQuYW5hbHlzaXMuZGVzY3JpcHRpb259YCxcbiAgICAgIGNvbmZpZGVuY2U6IHtcbiAgICAgICAgYXVkaW86IGF1ZGlvUmVzdWx0LmNvbmZpZGVuY2UsXG4gICAgICAgIGltYWdlOiBpbWFnZVJlc3VsdC5hbmFseXNpcy5jb25maWRlbmNlIHx8IDAuOSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeHRyYWlyIHRleHRvIGRlIGltYWdlbSAoT0NSKVxuICAgKi9cbiAgYXN5bmMgZXh0cmFjdFRleHRGcm9tSW1hZ2UoaW1hZ2VCdWZmZXIsIGZvcm1hdCA9IFwicG5nXCIpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+ThCBFeHRyYWluZG8gdGV4dG8gZGEgaW1hZ2VtLi4uYCk7XG5cbiAgICBjb25zdCBhbmFseXNpcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZUltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQpO1xuXG4gICAgaWYgKGFuYWx5c2lzLnRleHREZXRlY3Rpb24gJiYgYW5hbHlzaXMudGV4dERldGVjdGlvbi5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBleHRyYWN0ZWRUZXh0ID0gYW5hbHlzaXMudGV4dERldGVjdGlvbi5tYXAoKGl0ZW0pID0+IGl0ZW0udGV4dCkuam9pbihcIlxcblwiKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgdGV4dDogZXh0cmFjdGVkVGV4dCxcbiAgICAgICAgY29uZmlkZW5jZTogYW5hbHlzaXMudGV4dERldGVjdGlvblswXS5jb25maWRlbmNlIHx8IDAuOSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgdGV4dDogXCJcIixcbiAgICAgIG1lc3NhZ2U6IFwiTmVuaHVtIHRleHRvIGVuY29udHJhZG8gbmEgaW1hZ2VtXCIsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXNjcmV2ZXIgaW1hZ2VtXG4gICAqL1xuICBhc3luYyBkZXNjcmliZUltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQgPSBcInBuZ1wiKSB7XG4gICAgY29uc29sZS5sb2coYPCfk7ggRGVzY3JldmVuZG8gaW1hZ2VtLi4uYCk7XG5cbiAgICBjb25zdCBhbmFseXNpcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZUltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGRlc2NyaXB0aW9uOiBhbmFseXNpcy5kZXNjcmlwdGlvbixcbiAgICAgIGxhYmVsczogYW5hbHlzaXMubGFiZWxzIHx8IFtdLFxuICAgICAgb2JqZWN0czogYW5hbHlzaXMub2JqZWN0cyB8fCBbXSxcbiAgICAgIGNvbmZpZGVuY2U6IGFuYWx5c2lzLmNvbmZpZGVuY2UgfHwgMC45LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0YXIgY8OzZGlnbyBlbSBpbWFnZW1cbiAgICovXG4gIGFzeW5jIGRldGVjdENvZGVJbkltYWdlKGltYWdlQnVmZmVyLCBmb3JtYXQgPSBcInBuZ1wiKSB7XG4gICAgY29uc29sZS5sb2coYPCfkrsgRGV0ZWN0YW5kbyBjw7NkaWdvIG5hIGltYWdlbS4uLmApO1xuXG4gICAgY29uc3QgdGV4dFJlc3VsdCA9IGF3YWl0IHRoaXMuZXh0cmFjdFRleHRGcm9tSW1hZ2UoaW1hZ2VCdWZmZXIsIGZvcm1hdCk7XG5cbiAgICBpZiAoIXRleHRSZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGNvZGU6IFwiXCIsXG4gICAgICAgIGxhbmd1YWdlOiBudWxsLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBEZXRlY3RhciBsaW5ndWFnZW0gZGUgcHJvZ3JhbWHDp8Ojb1xuICAgIGNvbnN0IGxhbmd1YWdlID0gdGhpcy5kZXRlY3RQcm9ncmFtbWluZ0xhbmd1YWdlKHRleHRSZXN1bHQudGV4dCk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGNvZGU6IHRleHRSZXN1bHQudGV4dCxcbiAgICAgIGxhbmd1YWdlLFxuICAgICAgY29uZmlkZW5jZTogdGV4dFJlc3VsdC5jb25maWRlbmNlLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0YXIgbGluZ3VhZ2VtIGRlIHByb2dyYW1hw6fDo29cbiAgICovXG4gIGRldGVjdFByb2dyYW1taW5nTGFuZ3VhZ2UoY29kZSkge1xuICAgIGNvbnN0IHBhdHRlcm5zID0ge1xuICAgICAgamF2YXNjcmlwdDogL2NvbnN0fGxldHx2YXJ8ZnVuY3Rpb258PT58YXN5bmN8YXdhaXQvLFxuICAgICAgcHl0aG9uOiAvZGVmfGltcG9ydHxjbGFzc3xpZiBfX25hbWVfX3xwcmludFxcKC8sXG4gICAgICBqYXZhOiAvcHVibGljIGNsYXNzfHB1YmxpYyBzdGF0aWN8aW1wb3J0IGphdmEvLFxuICAgICAgY3BwOiAvI2luY2x1ZGV8c3RkOjp8aW50IG1haW4vLFxuICAgICAgY3NoYXJwOiAvdXNpbmd8bmFtZXNwYWNlfHB1YmxpYyBjbGFzc3xhc3luYyBUYXNrLyxcbiAgICAgIGdvOiAvcGFja2FnZSBtYWlufGZ1bmN8aW1wb3J0LyxcbiAgICAgIHJ1c3Q6IC9mbiB8bGV0IHxwdWIgfGltcGwgLyxcbiAgICAgIHNxbDogL1NFTEVDVHxJTlNFUlR8VVBEQVRFfERFTEVURXxGUk9NfFdIRVJFLyxcbiAgICAgIGh0bWw6IC88IURPQ1RZUEV8PGh0bWx8PGJvZHl8PGRpdi8sXG4gICAgICBjc3M6IC9AbWVkaWF8XFwuY2xhc3N8I2lkfHsuKjouKjt9LyxcbiAgICB9O1xuXG4gICAgZm9yIChjb25zdCBbbGFuZywgcGF0dGVybl0gb2YgT2JqZWN0LmVudHJpZXMocGF0dGVybnMpKSB7XG4gICAgICBpZiAocGF0dGVybi50ZXN0KGNvZGUpKSB7XG4gICAgICAgIHJldHVybiBsYW5nO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXIgYXJxdWl2byBkZSDDoXVkaW9cbiAgICovXG4gIHZhbGlkYXRlQXVkaW9GaWxlKGZpbGVuYW1lLCBzaXplKSB7XG4gICAgY29uc3QgZXh0ID0gZmlsZW5hbWUuc3BsaXQoXCIuXCIpLnBvcCgpLnRvTG93ZXJDYXNlKCk7XG5cbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkQXVkaW9Gb3JtYXRzLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBGb3JtYXRvIG7Do28gc3Vwb3J0YWRvOiAke2V4dH1gLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoc2l6ZSA+IHRoaXMubWF4QXVkaW9TaXplKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgQXJxdWl2byBtdWl0byBncmFuZGU6ICR7c2l6ZX0gYnl0ZXMgKG3DoXhpbW86ICR7dGhpcy5tYXhBdWRpb1NpemV9KWAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhciBhcnF1aXZvIGRlIGltYWdlbVxuICAgKi9cbiAgdmFsaWRhdGVJbWFnZUZpbGUoZmlsZW5hbWUsIHNpemUpIHtcbiAgICBjb25zdCBleHQgPSBmaWxlbmFtZS5zcGxpdChcIi5cIikucG9wKCkudG9Mb3dlckNhc2UoKTtcblxuICAgIGlmICghdGhpcy5zdXBwb3J0ZWRJbWFnZUZvcm1hdHMuaW5jbHVkZXMoZXh0KSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICBlcnJvcjogYEZvcm1hdG8gbsOjbyBzdXBvcnRhZG86ICR7ZXh0fWAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmIChzaXplID4gdGhpcy5tYXhJbWFnZVNpemUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBBcnF1aXZvIG11aXRvIGdyYW5kZTogJHtzaXplfSBieXRlcyAobcOheGltbzogJHt0aGlzLm1heEltYWdlU2l6ZX0pYCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgdmFsaWQ6IHRydWUgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRlciBpbmZvcm1hw6fDtWVzIGRlIHN1cG9ydGVcbiAgICovXG4gIGdldFN1cHBvcnRJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBhdWRpbzoge1xuICAgICAgICBmb3JtYXRzOiB0aGlzLnN1cHBvcnRlZEF1ZGlvRm9ybWF0cyxcbiAgICAgICAgbWF4U2l6ZTogdGhpcy5tYXhBdWRpb1NpemUsXG4gICAgICAgIGZlYXR1cmVzOiBbXCJTcGVlY2gtdG8tVGV4dFwiLCBcIlRyYW5zY3JpcHRpb25cIiwgXCJMYW5ndWFnZSBEZXRlY3Rpb25cIl0sXG4gICAgICB9LFxuICAgICAgaW1hZ2U6IHtcbiAgICAgICAgZm9ybWF0czogdGhpcy5zdXBwb3J0ZWRJbWFnZUZvcm1hdHMsXG4gICAgICAgIG1heFNpemU6IHRoaXMubWF4SW1hZ2VTaXplLFxuICAgICAgICBmZWF0dXJlczogW1wiT0NSXCIsIFwiT2JqZWN0IERldGVjdGlvblwiLCBcIkxhYmVsIERldGVjdGlvblwiLCBcIkNvZGUgRGV0ZWN0aW9uXCJdLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE11bHRpbW9kYWxQcm9jZXNzb3I7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsbUJBQW1CLENBQUM7RUFDeEJDLFdBQVdBLENBQUEsRUFBRztJQUNaLElBQUksQ0FBQ0MscUJBQXFCLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQztJQUN4RSxJQUFJLENBQUNDLHFCQUFxQixHQUFHLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUM7SUFDekUsSUFBSSxDQUFDQyxZQUFZLEdBQUcsRUFBRSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQztJQUN0QyxJQUFJLENBQUNDLFlB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