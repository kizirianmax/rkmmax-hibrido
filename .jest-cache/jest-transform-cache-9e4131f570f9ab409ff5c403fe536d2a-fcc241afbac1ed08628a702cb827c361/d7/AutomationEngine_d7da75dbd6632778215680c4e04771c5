7b83799d4a2b8397328b6dac2cd6e58b
"use strict";

var _interopRequireDefault = require("/home/runner/work/rkmmax-hibrido/rkmmax-hibrido/node_modules/@babel/runtime/helpers/interopRequireDefault.js").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _SecurityValidator = _interopRequireDefault(require("./SecurityValidator.js"));
var _AuditLogger = _interopRequireDefault(require("./AuditLogger.js"));
var _GitHubAutomation = _interopRequireDefault(require("./GitHubAutomation.js"));
var _SpecialistSelector = _interopRequireDefault(require("./SpecialistSelector.js"));
/**
 * AUTOMATION ENGINE
 * Motor central de automaÃ§Ã£o que orquestra todo o processo
 * Coordena: AnÃ¡lise â†’ SeleÃ§Ã£o de Especialista â†’ GeraÃ§Ã£o de CÃ³digo â†’ ValidaÃ§Ã£o â†’ Commit
 */

class AutomationEngine {
  constructor(config = {}) {
    this.config = {
      maxRetries: config.maxRetries || 3,
      timeout: config.timeout || 30000,
      aiModel: config.aiModel || "gemini-2.0-flash",
      temperature: config.temperature || 0.7,
      ...config
    };
    this.validator = new _SecurityValidator.default();
    this.auditLogger = new _AuditLogger.default();
    this.specialistSelector = new _SpecialistSelector.default();

    // GitHub serÃ¡ inicializado quando necessÃ¡rio
    this.gitHub = null;
  }

  /**
   * Inicializar GitHub Automation
   */
  initializeGitHub(token) {
    try {
      this.gitHub = new _GitHubAutomation.default(token);
      return true;
    } catch (error) {
      console.error("Erro ao inicializar GitHub:", error);
      return false;
    }
  }

  /**
   * Executar automaÃ§Ã£o completa
   */
  async executeAutomation(request) {
    const automationId = this.auditLogger.logAutomationRequest({
      userId: request.userId,
      username: request.username,
      command: request.command,
      mode: request.mode || "OPTIMIZED",
      selectedSpecialist: request.selectedSpecialist,
      description: request.description,
      ipAddress: request.ipAddress,
      userAgent: request.userAgent,
      sessionId: request.sessionId
    });
    const result = {
      automationId,
      status: "INITIATED",
      steps: [],
      errors: []
    };
    try {
      var _commitResult, _prResult, _commitResult2, _prResult2;
      // Fase 1: AnÃ¡lise do comando
      console.log(`\nðŸ“‹ FASE 1: AnÃ¡lise do comando`);
      const analysis = await this.analyzeCommand(request.command);
      result.steps.push({
        phase: "ANALYSIS",
        status: "COMPLETED",
        details: analysis
      });

      // Fase 2: SeleÃ§Ã£o de especialista
      console.log(`\nðŸŽ¯ FASE 2: SeleÃ§Ã£o de especialista`);
      let specialist;
      if (request.mode === "HYBRID" && request.selectedSpecialist) {
        specialist = request.selectedSpecialist;
        console.log(`âœ… Especialista selecionado manualmente: ${specialist}`);
      } else {
        specialist = await this.specialistSelector.selectSpecialist(analysis.taskType, analysis.keywords);
        console.log(`âœ… Especialista selecionado automaticamente: ${specialist}`);
      }
      result.steps.push({
        phase: "SPECIALIST_SELECTION",
        status: "COMPLETED",
        specialist,
        mode: request.mode
      });

      // Fase 3: GeraÃ§Ã£o de cÃ³digo
      console.log(`\nðŸ’» FASE 3: GeraÃ§Ã£o de cÃ³digo`);
      const codeGeneration = await this.generateCode(analysis, specialist, request.repositoryInfo);
      result.steps.push({
        phase: "CODE_GENERATION",
        status: "COMPLETED",
        filesGenerated: codeGeneration.files.length,
        linesOfCode: codeGeneration.totalLines
      });

      // Fase 4: ValidaÃ§Ã£o de seguranÃ§a
      console.log(`\nðŸ” FASE 4: ValidaÃ§Ã£o de seguranÃ§a`);
      const securityValidation = await this.validateCode(codeGeneration.files);
      if (!securityValidation.isValid) {
        result.status = "BLOCKED";
        result.errors.push({
          phase: "SECURITY_VALIDATION",
          message: "CÃ³digo bloqueado por validaÃ§Ã£o de seguranÃ§a",
          details: securityValidation
        });
        this.auditLogger.logSecurityValidation({
          automationId,
          filesChecked: codeGeneration.files.length,
          isValid: false,
          severity: securityValidation.severity,
          errors: securityValidation.errors,
          warnings: securityValidation.warnings
        });
        return result;
      }
      result.steps.push({
        phase: "SECURITY_VALIDATION",
        status: "COMPLETED",
        warnings: securityValidation.warnings.length
      });

      // Fase 5: Commit + Push
      console.log(`\nðŸ“ FASE 5: Commit + Push`);
      let commitResult = null;
      if (request.repositoryInfo && this.gitHub) {
        commitResult = await this.commitAndPush(codeGeneration.files, analysis.commitMessage, request.repositoryInfo, specialist);
        result.steps.push({
          phase: "GIT_COMMIT",
          status: "COMPLETED",
          commitHash: commitResult.commit.sha,
          filesChanged: commitResult.filesChanged
        });
      }

      // Fase 6: Criar PR (opcional)
      console.log(`\nðŸ”€ FASE 6: Criar Pull Request (opcional)`);
      let prResult = null;
      if (request.createPR && this.gitHub && commitResult) {
        prResult = await this.createPullRequest(analysis, specialist, request.repositoryInfo);
        result.steps.push({
          phase: "CREATE_PR",
          status: "COMPLETED",
          prNumber: prResult.pr.number,
          prUrl: prResult.pr.url
        });
      }

      // Sucesso!
      result.status = "SUCCESS";
      result.output = {
        files: codeGeneration.files,
        commit: (_commitResult = commitResult) === null || _commitResult === void 0 ? void 0 : _commitResult.commit,
        pr: (_prResult = prResult) === null || _prResult === void 0 ? void 0 : _prResult.pr
      };

      // Log de conclusÃ£o
      this.auditLogger.logAutomationCompletion({
        automationId,
        userId: request.userId,
        status: "SUCCESS",
        totalDuration: result.totalDuration,
        commitHash: (_commitResult2 = commitResult) === null || _commitResult2 === void 0 ? void 0 : _commitResult2.commit.sha,
        prUrl: (_prResult2 = prResult) === null || _prResult2 === void 0 ? void 0 : _prResult2.pr.url,
        filesCreated: codeGeneration.files.length,
        linesAdded: codeGeneration.totalLines,
        specialist,
        mode: request.mode,
        creditsUsed: request.creditsUsed
      });
      return result;
    } catch (error) {
      var _result$steps;
      console.error(`âŒ Erro na automaÃ§Ã£o: ${error.message}`);
      result.status = "FAILED";
      result.errors.push({
        message: error.message,
        stack: error.stack
      });

      // Log de erro
      this.auditLogger.logError({
        automationId,
        userId: request.userId,
        errorType: error.constructor.name,
        errorMessage: error.message,
        errorStack: error.stack,
        phase: ((_result$steps = result.steps[result.steps.length - 1]) === null || _result$steps === void 0 ? void 0 : _result$steps.phase) || "UNKNOWN"
      });
      return result;
    }
  }

  /**
   * Analisar comando do usuÃ¡rio
   */
  async analyzeCommand(command) {
    // Aqui seria chamada uma IA para analisar o comando
    // Por enquanto, anÃ¡lise simples

    const keywords = command.toLowerCase().split(" ");
    let taskType = "GENERAL";
    if (command.includes("componente") || command.includes("component")) taskType = "COMPONENT";
    if (command.includes("funÃ§Ã£o") || command.includes("function")) taskType = "FUNCTION";
    if (command.includes("teste") || command.includes("test")) taskType = "TEST";
    if (command.includes("estilo") || command.includes("style")) taskType = "STYLE";
    if (command.includes("documentaÃ§Ã£o") || command.includes("documentation")) taskType = "DOCUMENTATION";
    if (command.includes("refatorar") || command.includes("refactor")) taskType = "REFACTOR";
    return {
      command,
      taskType,
      keywords,
      commitMessage: `feat: ${command.substring(0, 50)}`,
      description: command
    };
  }

  /**
   * Gerar cÃ³digo via IA
   */
  async generateCode(analysis, specialist, repositoryInfo) {
    // Aqui seria chamada a IA (Gemini, GROQ, etc)
    // Por enquanto, simulaÃ§Ã£o

    console.log(`ðŸ¤– Gerando cÃ³digo com ${specialist}...`);

    // Simular geraÃ§Ã£o de cÃ³digo
    const files = [{
      path: `src/generated_${Date.now()}.js`,
      content: `// Gerado automaticamente por ${specialist}\n// Tarefa: ${analysis.description}\n\nexport default function generated() {\n  // CÃ³digo gerado aqui\n}\n`
    }];
    return {
      files,
      totalLines: files.reduce((sum, f) => sum + f.content.split("\n").length, 0),
      specialist
    };
  }

  /**
   * Validar cÃ³digo
   */
  async validateCode(files) {
    console.log(`ðŸ” Validando ${files.length} arquivos...`);
    const validation = await this.validator.validateFiles(files);
    if (!validation.isValid) {
      console.log(`âŒ ValidaÃ§Ã£o falhou!`);
      return {
        isValid: false,
        severity: "critical",
        errors: validation.details.flatMap(d => d.errors),
        warnings: validation.details.flatMap(d => d.warnings)
      };
    }
    console.log(`âœ… CÃ³digo validado com sucesso!`);
    return {
      isValid: true,
      severity: "none",
      errors: [],
      warnings: validation.details.flatMap(d => d.warnings)
    };
  }

  /**
   * Fazer commit + push
   */
  async commitAndPush(files, message, repositoryInfo, specialist) {
    console.log(`ðŸ“ Fazendo commit + push...`);
    if (!this.gitHub) {
      throw new Error("GitHub nÃ£o inicializado");
    }
    const result = await this.gitHub.commitAndPush(repositoryInfo.owner, repositoryInfo.repo, files, message, repositoryInfo.branch || "main", {
      name: `${specialist} Bot`,
      email: `${specialist.toLowerCase()}@rkmmax.com`
    });
    console.log(`âœ… Commit realizado: ${result.commit.sha.substring(0, 7)}`);
    return result;
  }

  /**
   * Criar Pull Request
   */
  async createPullRequest(analysis, specialist, repositoryInfo) {
    console.log(`ðŸ”€ Criando Pull Request...`);
    if (!this.gitHub) {
      throw new Error("GitHub nÃ£o inicializado");
    }
    const branchName = `automation/${specialist.toLowerCase()}/${Date.now()}`;
    const pr = await this.gitHub.createPullRequest(repositoryInfo.owner, repositoryInfo.repo, `[${specialist}] ${analysis.commitMessage}`, `AutomaÃ§Ã£o executada por ${specialist}\n\nTarefa: ${analysis.description}`, branchName, repositoryInfo.branch || "main");
    console.log(`âœ… PR criado: ${pr.url}`);
    return {
      pr
    };
  }

  /**
   * Obter histÃ³rico de automaÃ§Ãµes
   */
  getAutomationHistory(userId, limit = 50) {
    return this.auditLogger.searchLogs({
      type: "AUTOMATION_REQUEST",
      userId
    }).slice(-limit);
  }

  /**
   * Obter estatÃ­sticas de automaÃ§Ã£o
   */
  getAutomationStats(userId) {
    const logs = this.auditLogger.searchLogs({
      userId
    });
    const stats = {
      totalAutomations: logs.length,
      successfulAutomations: logs.filter(l => l.status === "SUCCESS").length,
      failedAutomations: logs.filter(l => l.status === "FAILED").length,
      blockedAutomations: logs.filter(l => l.status === "BLOCKED").length,
      byMode: {},
      bySpecialist: {}
    };
    logs.forEach(log => {
      if (log.mode) {
        stats.byMode[log.mode] = (stats.byMode[log.mode] || 0) + 1;
      }
      if (log.selectedSpecialist) {
        stats.bySpecialist[log.selectedSpecialist] = (stats.bySpecialist[log.selectedSpecialist] || 0) + 1;
      }
    });
    return stats;
  }
}
var _default = exports.default = AutomationEngine;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfU2VjdXJpdHlWYWxpZGF0b3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9BdWRpdExvZ2dlciIsIl9HaXRIdWJBdXRvbWF0aW9uIiwiX1NwZWNpYWxpc3RTZWxlY3RvciIsIkF1dG9tYXRpb25FbmdpbmUiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsIm1heFJldHJpZXMiLCJ0aW1lb3V0IiwiYWlNb2RlbCIsInRlbXBlcmF0dXJlIiwidmFsaWRhdG9yIiwiU2VjdXJpdHlWYWxpZGF0b3IiLCJhdWRpdExvZ2dlciIsIkF1ZGl0TG9nZ2VyIiwic3BlY2lhbGlzdFNlbGVjdG9yIiwiU3BlY2lhbGlzdFNlbGVjdG9yIiwiZ2l0SHViIiwiaW5pdGlhbGl6ZUdpdEh1YiIsInRva2VuIiwiR2l0SHViQXV0b21hdGlvbiIsImVycm9yIiwiY29uc29sZSIsImV4ZWN1dGVBdXRvbWF0aW9uIiwicmVxdWVzdCIsImF1dG9tYXRpb25JZCIsImxvZ0F1dG9tYXRpb25SZXF1ZXN0IiwidXNlcklkIiwidXNlcm5hbWUiLCJjb21tYW5kIiwibW9kZSIsInNlbGVjdGVkU3BlY2lhbGlzdCIsImRlc2NyaXB0aW9uIiwiaXBBZGRyZXNzIiwidXNlckFnZW50Iiwic2Vzc2lvbklkIiwicmVzdWx0Iiwic3RhdHVzIiwic3RlcHMiLCJlcnJvcnMiLCJfY29tbWl0UmVzdWx0IiwiX3ByUmVzdWx0IiwiX2NvbW1pdFJlc3VsdDIiLCJfcHJSZXN1bHQyIiwibG9nIiwiYW5hbHlzaXMiLCJhbmFseXplQ29tbWFuZCIsInB1c2giLCJwaGFzZSIsImRldGFpbHMiLCJzcGVjaWFsaXN0Iiwic2VsZWN0U3BlY2lhbGlzdCIsInRhc2tUeXBlIiwia2V5d29yZHMiLCJjb2RlR2VuZXJhdGlvbiIsImdlbmVyYXRlQ29kZSIsInJlcG9zaXRvcnlJbmZvIiwiZmlsZXNHZW5lcmF0ZWQiLCJmaWxlcyIsImxlbmd0aCIsImxpbmVzT2ZDb2RlIiwidG90YWxMaW5lcyIsInNlY3VyaXR5VmFsaWRhdGlvbiIsInZhbGlkYXRlQ29kZSIsImlzVmFsaWQiLCJtZXNzYWdlIiwibG9nU2VjdXJpdHlWYWxpZGF0aW9uIiwiZmlsZXNDaGVja2VkIiwic2V2ZXJpdHkiLCJ3YXJuaW5ncyIsImNvbW1pdFJlc3VsdCIsImNvbW1pdEFuZFB1c2giLCJjb21taXRNZXNzYWdlIiwiY29tbWl0SGFzaCIsImNvbW1pdCIsInNoYSIsImZpbGVzQ2hhbmdlZCIsInByUmVzdWx0IiwiY3JlYXRlUFIiLCJjcmVhdGVQdWxsUmVxdWVzdCIsInByTnVtYmVyIiwicHIiLCJudW1iZXIiLCJwclVybCIsInVybCIsIm91dHB1dCIsImxvZ0F1dG9tYXRpb25Db21wbGV0aW9uIiwidG90YWxEdXJhdGlvbiIsImZpbGVzQ3JlYXRlZCIsImxpbmVzQWRkZWQiLCJjcmVkaXRzVXNlZCIsIl9yZXN1bHQkc3RlcHMiLCJzdGFjayIsImxvZ0Vycm9yIiwiZXJyb3JUeXBlIiwibmFtZSIsImVycm9yTWVzc2FnZSIsImVycm9yU3RhY2siLCJ0b0xvd2VyQ2FzZSIsInNwbGl0IiwiaW5jbHVkZXMiLCJzdWJzdHJpbmciLCJwYXRoIiwiRGF0ZSIsIm5vdyIsImNvbnRlbnQiLCJyZWR1Y2UiLCJzdW0iLCJmIiwidmFsaWRhdGlvbiIsInZhbGlkYXRlRmlsZXMiLCJmbGF0TWFwIiwiZCIsIkVycm9yIiwib3duZXIiLCJyZXBvIiwiYnJhbmNoIiwiZW1haWwiLCJicmFuY2hOYW1lIiwiZ2V0QXV0b21hdGlvbkhpc3RvcnkiLCJsaW1pdCIsInNlYXJjaExvZ3MiLCJ0eXBlIiwic2xpY2UiLCJnZXRBdXRvbWF0aW9uU3RhdHMiLCJsb2dzIiwic3RhdHMiLCJ0b3RhbEF1dG9tYXRpb25zIiwic3VjY2Vzc2Z1bEF1dG9tYXRpb25zIiwiZmlsdGVyIiwibCIsImZhaWxlZEF1dG9tYXRpb25zIiwiYmxvY2tlZEF1dG9tYXRpb25zIiwiYnlNb2RlIiwiYnlTcGVjaWFsaXN0IiwiZm9yRWFjaCIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyJBdXRvbWF0aW9uRW5naW5lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQVVUT01BVElPTiBFTkdJTkVcbiAqIE1vdG9yIGNlbnRyYWwgZGUgYXV0b21hw6fDo28gcXVlIG9ycXVlc3RyYSB0b2RvIG8gcHJvY2Vzc29cbiAqIENvb3JkZW5hOiBBbsOhbGlzZSDihpIgU2VsZcOnw6NvIGRlIEVzcGVjaWFsaXN0YSDihpIgR2VyYcOnw6NvIGRlIEPDs2RpZ28g4oaSIFZhbGlkYcOnw6NvIOKGkiBDb21taXRcbiAqL1xuXG5pbXBvcnQgU2VjdXJpdHlWYWxpZGF0b3IgZnJvbSBcIi4vU2VjdXJpdHlWYWxpZGF0b3IuanNcIjtcbmltcG9ydCBBdWRpdExvZ2dlciBmcm9tIFwiLi9BdWRpdExvZ2dlci5qc1wiO1xuaW1wb3J0IEdpdEh1YkF1dG9tYXRpb24gZnJvbSBcIi4vR2l0SHViQXV0b21hdGlvbi5qc1wiO1xuaW1wb3J0IFNwZWNpYWxpc3RTZWxlY3RvciBmcm9tIFwiLi9TcGVjaWFsaXN0U2VsZWN0b3IuanNcIjtcblxuY2xhc3MgQXV0b21hdGlvbkVuZ2luZSB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZyA9IHt9KSB7XG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICBtYXhSZXRyaWVzOiBjb25maWcubWF4UmV0cmllcyB8fCAzLFxuICAgICAgdGltZW91dDogY29uZmlnLnRpbWVvdXQgfHwgMzAwMDAsXG4gICAgICBhaU1vZGVsOiBjb25maWcuYWlNb2RlbCB8fCBcImdlbWluaS0yLjAtZmxhc2hcIixcbiAgICAgIHRlbXBlcmF0dXJlOiBjb25maWcudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgLi4uY29uZmlnLFxuICAgIH07XG5cbiAgICB0aGlzLnZhbGlkYXRvciA9IG5ldyBTZWN1cml0eVZhbGlkYXRvcigpO1xuICAgIHRoaXMuYXVkaXRMb2dnZXIgPSBuZXcgQXVkaXRMb2dnZXIoKTtcbiAgICB0aGlzLnNwZWNpYWxpc3RTZWxlY3RvciA9IG5ldyBTcGVjaWFsaXN0U2VsZWN0b3IoKTtcblxuICAgIC8vIEdpdEh1YiBzZXLDoSBpbmljaWFsaXphZG8gcXVhbmRvIG5lY2Vzc8OhcmlvXG4gICAgdGhpcy5naXRIdWIgPSBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaWNpYWxpemFyIEdpdEh1YiBBdXRvbWF0aW9uXG4gICAqL1xuICBpbml0aWFsaXplR2l0SHViKHRva2VuKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuZ2l0SHViID0gbmV3IEdpdEh1YkF1dG9tYXRpb24odG9rZW4pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvIGFvIGluaWNpYWxpemFyIEdpdEh1YjpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRhciBhdXRvbWHDp8OjbyBjb21wbGV0YVxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZUF1dG9tYXRpb24ocmVxdWVzdCkge1xuICAgIGNvbnN0IGF1dG9tYXRpb25JZCA9IHRoaXMuYXVkaXRMb2dnZXIubG9nQXV0b21hdGlvblJlcXVlc3Qoe1xuICAgICAgdXNlcklkOiByZXF1ZXN0LnVzZXJJZCxcbiAgICAgIHVzZXJuYW1lOiByZXF1ZXN0LnVzZXJuYW1lLFxuICAgICAgY29tbWFuZDogcmVxdWVzdC5jb21tYW5kLFxuICAgICAgbW9kZTogcmVxdWVzdC5tb2RlIHx8IFwiT1BUSU1JWkVEXCIsXG4gICAgICBzZWxlY3RlZFNwZWNpYWxpc3Q6IHJlcXVlc3Quc2VsZWN0ZWRTcGVjaWFsaXN0LFxuICAgICAgZGVzY3JpcHRpb246IHJlcXVlc3QuZGVzY3JpcHRpb24sXG4gICAgICBpcEFkZHJlc3M6IHJlcXVlc3QuaXBBZGRyZXNzLFxuICAgICAgdXNlckFnZW50OiByZXF1ZXN0LnVzZXJBZ2VudCxcbiAgICAgIHNlc3Npb25JZDogcmVxdWVzdC5zZXNzaW9uSWQsXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICBhdXRvbWF0aW9uSWQsXG4gICAgICBzdGF0dXM6IFwiSU5JVElBVEVEXCIsXG4gICAgICBzdGVwczogW10sXG4gICAgICBlcnJvcnM6IFtdLFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgLy8gRmFzZSAxOiBBbsOhbGlzZSBkbyBjb21hbmRvXG4gICAgICBjb25zb2xlLmxvZyhgXFxu8J+TiyBGQVNFIDE6IEFuw6FsaXNlIGRvIGNvbWFuZG9gKTtcbiAgICAgIGNvbnN0IGFuYWx5c2lzID0gYXdhaXQgdGhpcy5hbmFseXplQ29tbWFuZChyZXF1ZXN0LmNvbW1hbmQpO1xuICAgICAgcmVzdWx0LnN0ZXBzLnB1c2goe1xuICAgICAgICBwaGFzZTogXCJBTkFMWVNJU1wiLFxuICAgICAgICBzdGF0dXM6IFwiQ09NUExFVEVEXCIsXG4gICAgICAgIGRldGFpbHM6IGFuYWx5c2lzLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEZhc2UgMjogU2VsZcOnw6NvIGRlIGVzcGVjaWFsaXN0YVxuICAgICAgY29uc29sZS5sb2coYFxcbvCfjq8gRkFTRSAyOiBTZWxlw6fDo28gZGUgZXNwZWNpYWxpc3RhYCk7XG4gICAgICBsZXQgc3BlY2lhbGlzdDtcblxuICAgICAgaWYgKHJlcXVlc3QubW9kZSA9PT0gXCJIWUJSSURcIiAmJiByZXF1ZXN0LnNlbGVjdGVkU3BlY2lhbGlzdCkge1xuICAgICAgICBzcGVjaWFsaXN0ID0gcmVxdWVzdC5zZWxlY3RlZFNwZWNpYWxpc3Q7XG4gICAgICAgIGNvbnNvbGUubG9nKGDinIUgRXNwZWNpYWxpc3RhIHNlbGVjaW9uYWRvIG1hbnVhbG1lbnRlOiAke3NwZWNpYWxpc3R9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGVjaWFsaXN0ID0gYXdhaXQgdGhpcy5zcGVjaWFsaXN0U2VsZWN0b3Iuc2VsZWN0U3BlY2lhbGlzdChcbiAgICAgICAgICBhbmFseXNpcy50YXNrVHlwZSxcbiAgICAgICAgICBhbmFseXNpcy5rZXl3b3Jkc1xuICAgICAgICApO1xuICAgICAgICBjb25zb2xlLmxvZyhg4pyFIEVzcGVjaWFsaXN0YSBzZWxlY2lvbmFkbyBhdXRvbWF0aWNhbWVudGU6ICR7c3BlY2lhbGlzdH1gKTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0LnN0ZXBzLnB1c2goe1xuICAgICAgICBwaGFzZTogXCJTUEVDSUFMSVNUX1NFTEVDVElPTlwiLFxuICAgICAgICBzdGF0dXM6IFwiQ09NUExFVEVEXCIsXG4gICAgICAgIHNwZWNpYWxpc3QsXG4gICAgICAgIG1vZGU6IHJlcXVlc3QubW9kZSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGYXNlIDM6IEdlcmHDp8OjbyBkZSBjw7NkaWdvXG4gICAgICBjb25zb2xlLmxvZyhgXFxu8J+SuyBGQVNFIDM6IEdlcmHDp8OjbyBkZSBjw7NkaWdvYCk7XG4gICAgICBjb25zdCBjb2RlR2VuZXJhdGlvbiA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVDb2RlKGFuYWx5c2lzLCBzcGVjaWFsaXN0LCByZXF1ZXN0LnJlcG9zaXRvcnlJbmZvKTtcblxuICAgICAgcmVzdWx0LnN0ZXBzLnB1c2goe1xuICAgICAgICBwaGFzZTogXCJDT0RFX0dFTkVSQVRJT05cIixcbiAgICAgICAgc3RhdHVzOiBcIkNPTVBMRVRFRFwiLFxuICAgICAgICBmaWxlc0dlbmVyYXRlZDogY29kZUdlbmVyYXRpb24uZmlsZXMubGVuZ3RoLFxuICAgICAgICBsaW5lc09mQ29kZTogY29kZUdlbmVyYXRpb24udG90YWxMaW5lcyxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGYXNlIDQ6IFZhbGlkYcOnw6NvIGRlIHNlZ3VyYW7Dp2FcbiAgICAgIGNvbnNvbGUubG9nKGBcXG7wn5SQIEZBU0UgNDogVmFsaWRhw6fDo28gZGUgc2VndXJhbsOnYWApO1xuICAgICAgY29uc3Qgc2VjdXJpdHlWYWxpZGF0aW9uID0gYXdhaXQgdGhpcy52YWxpZGF0ZUNvZGUoY29kZUdlbmVyYXRpb24uZmlsZXMpO1xuXG4gICAgICBpZiAoIXNlY3VyaXR5VmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgIHJlc3VsdC5zdGF0dXMgPSBcIkJMT0NLRURcIjtcbiAgICAgICAgcmVzdWx0LmVycm9ycy5wdXNoKHtcbiAgICAgICAgICBwaGFzZTogXCJTRUNVUklUWV9WQUxJREFUSU9OXCIsXG4gICAgICAgICAgbWVzc2FnZTogXCJDw7NkaWdvIGJsb3F1ZWFkbyBwb3IgdmFsaWRhw6fDo28gZGUgc2VndXJhbsOnYVwiLFxuICAgICAgICAgIGRldGFpbHM6IHNlY3VyaXR5VmFsaWRhdGlvbixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hdWRpdExvZ2dlci5sb2dTZWN1cml0eVZhbGlkYXRpb24oe1xuICAgICAgICAgIGF1dG9tYXRpb25JZCxcbiAgICAgICAgICBmaWxlc0NoZWNrZWQ6IGNvZGVHZW5lcmF0aW9uLmZpbGVzLmxlbmd0aCxcbiAgICAgICAgICBpc1ZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBzZXZlcml0eTogc2VjdXJpdHlWYWxpZGF0aW9uLnNldmVyaXR5LFxuICAgICAgICAgIGVycm9yczogc2VjdXJpdHlWYWxpZGF0aW9uLmVycm9ycyxcbiAgICAgICAgICB3YXJuaW5nczogc2VjdXJpdHlWYWxpZGF0aW9uLndhcm5pbmdzLFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuXG4gICAgICByZXN1bHQuc3RlcHMucHVzaCh7XG4gICAgICAgIHBoYXNlOiBcIlNFQ1VSSVRZX1ZBTElEQVRJT05cIixcbiAgICAgICAgc3RhdHVzOiBcIkNPTVBMRVRFRFwiLFxuICAgICAgICB3YXJuaW5nczogc2VjdXJpdHlWYWxpZGF0aW9uLndhcm5pbmdzLmxlbmd0aCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGYXNlIDU6IENvbW1pdCArIFB1c2hcbiAgICAgIGNvbnNvbGUubG9nKGBcXG7wn5OdIEZBU0UgNTogQ29tbWl0ICsgUHVzaGApO1xuICAgICAgbGV0IGNvbW1pdFJlc3VsdCA9IG51bGw7XG5cbiAgICAgIGlmIChyZXF1ZXN0LnJlcG9zaXRvcnlJbmZvICYmIHRoaXMuZ2l0SHViKSB7XG4gICAgICAgIGNvbW1pdFJlc3VsdCA9IGF3YWl0IHRoaXMuY29tbWl0QW5kUHVzaChcbiAgICAgICAgICBjb2RlR2VuZXJhdGlvbi5maWxlcyxcbiAgICAgICAgICBhbmFseXNpcy5jb21taXRNZXNzYWdlLFxuICAgICAgICAgIHJlcXVlc3QucmVwb3NpdG9yeUluZm8sXG4gICAgICAgICAgc3BlY2lhbGlzdFxuICAgICAgICApO1xuXG4gICAgICAgIHJlc3VsdC5zdGVwcy5wdXNoKHtcbiAgICAgICAgICBwaGFzZTogXCJHSVRfQ09NTUlUXCIsXG4gICAgICAgICAgc3RhdHVzOiBcIkNPTVBMRVRFRFwiLFxuICAgICAgICAgIGNvbW1pdEhhc2g6IGNvbW1pdFJlc3VsdC5jb21taXQuc2hhLFxuICAgICAgICAgIGZpbGVzQ2hhbmdlZDogY29tbWl0UmVzdWx0LmZpbGVzQ2hhbmdlZCxcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEZhc2UgNjogQ3JpYXIgUFIgKG9wY2lvbmFsKVxuICAgICAgY29uc29sZS5sb2coYFxcbvCflIAgRkFTRSA2OiBDcmlhciBQdWxsIFJlcXVlc3QgKG9wY2lvbmFsKWApO1xuICAgICAgbGV0IHByUmVzdWx0ID0gbnVsbDtcblxuICAgICAgaWYgKHJlcXVlc3QuY3JlYXRlUFIgJiYgdGhpcy5naXRIdWIgJiYgY29tbWl0UmVzdWx0KSB7XG4gICAgICAgIHByUmVzdWx0ID0gYXdhaXQgdGhpcy5jcmVhdGVQdWxsUmVxdWVzdChhbmFseXNpcywgc3BlY2lhbGlzdCwgcmVxdWVzdC5yZXBvc2l0b3J5SW5mbyk7XG5cbiAgICAgICAgcmVzdWx0LnN0ZXBzLnB1c2goe1xuICAgICAgICAgIHBoYXNlOiBcIkNSRUFURV9QUlwiLFxuICAgICAgICAgIHN0YXR1czogXCJDT01QTEVURURcIixcbiAgICAgICAgICBwck51bWJlcjogcHJSZXN1bHQucHIubnVtYmVyLFxuICAgICAgICAgIHByVXJsOiBwclJlc3VsdC5wci51cmwsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTdWNlc3NvIVxuICAgICAgcmVzdWx0LnN0YXR1cyA9IFwiU1VDQ0VTU1wiO1xuICAgICAgcmVzdWx0Lm91dHB1dCA9IHtcbiAgICAgICAgZmlsZXM6IGNvZGVHZW5lcmF0aW9uLmZpbGVzLFxuICAgICAgICBjb21taXQ6IGNvbW1pdFJlc3VsdD8uY29tbWl0LFxuICAgICAgICBwcjogcHJSZXN1bHQ/LnByLFxuICAgICAgfTtcblxuICAgICAgLy8gTG9nIGRlIGNvbmNsdXPDo29cbiAgICAgIHRoaXMuYXVkaXRMb2dnZXIubG9nQXV0b21hdGlvbkNvbXBsZXRpb24oe1xuICAgICAgICBhdXRvbWF0aW9uSWQsXG4gICAgICAgIHVzZXJJZDogcmVxdWVzdC51c2VySWQsXG4gICAgICAgIHN0YXR1czogXCJTVUNDRVNTXCIsXG4gICAgICAgIHRvdGFsRHVyYXRpb246IHJlc3VsdC50b3RhbER1cmF0aW9uLFxuICAgICAgICBjb21taXRIYXNoOiBjb21taXRSZXN1bHQ/LmNvbW1pdC5zaGEsXG4gICAgICAgIHByVXJsOiBwclJlc3VsdD8ucHIudXJsLFxuICAgICAgICBmaWxlc0NyZWF0ZWQ6IGNvZGVHZW5lcmF0aW9uLmZpbGVzLmxlbmd0aCxcbiAgICAgICAgbGluZXNBZGRlZDogY29kZUdlbmVyYXRpb24udG90YWxMaW5lcyxcbiAgICAgICAgc3BlY2lhbGlzdCxcbiAgICAgICAgbW9kZTogcmVxdWVzdC5tb2RlLFxuICAgICAgICBjcmVkaXRzVXNlZDogcmVxdWVzdC5jcmVkaXRzVXNlZCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDinYwgRXJybyBuYSBhdXRvbWHDp8OjbzogJHtlcnJvci5tZXNzYWdlfWApO1xuXG4gICAgICByZXN1bHQuc3RhdHVzID0gXCJGQUlMRURcIjtcbiAgICAgIHJlc3VsdC5lcnJvcnMucHVzaCh7XG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBMb2cgZGUgZXJyb1xuICAgICAgdGhpcy5hdWRpdExvZ2dlci5sb2dFcnJvcih7XG4gICAgICAgIGF1dG9tYXRpb25JZCxcbiAgICAgICAgdXNlcklkOiByZXF1ZXN0LnVzZXJJZCxcbiAgICAgICAgZXJyb3JUeXBlOiBlcnJvci5jb25zdHJ1Y3Rvci5uYW1lLFxuICAgICAgICBlcnJvck1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIGVycm9yU3RhY2s6IGVycm9yLnN0YWNrLFxuICAgICAgICBwaGFzZTogcmVzdWx0LnN0ZXBzW3Jlc3VsdC5zdGVwcy5sZW5ndGggLSAxXT8ucGhhc2UgfHwgXCJVTktOT1dOXCIsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW5hbGlzYXIgY29tYW5kbyBkbyB1c3XDoXJpb1xuICAgKi9cbiAgYXN5bmMgYW5hbHl6ZUNvbW1hbmQoY29tbWFuZCkge1xuICAgIC8vIEFxdWkgc2VyaWEgY2hhbWFkYSB1bWEgSUEgcGFyYSBhbmFsaXNhciBvIGNvbWFuZG9cbiAgICAvLyBQb3IgZW5xdWFudG8sIGFuw6FsaXNlIHNpbXBsZXNcblxuICAgIGNvbnN0IGtleXdvcmRzID0gY29tbWFuZC50b0xvd2VyQ2FzZSgpLnNwbGl0KFwiIFwiKTtcblxuICAgIGxldCB0YXNrVHlwZSA9IFwiR0VORVJBTFwiO1xuICAgIGlmIChjb21tYW5kLmluY2x1ZGVzKFwiY29tcG9uZW50ZVwiKSB8fCBjb21tYW5kLmluY2x1ZGVzKFwiY29tcG9uZW50XCIpKSB0YXNrVHlwZSA9IFwiQ09NUE9ORU5UXCI7XG4gICAgaWYgKGNvbW1hbmQuaW5jbHVkZXMoXCJmdW7Dp8Ojb1wiKSB8fCBjb21tYW5kLmluY2x1ZGVzKFwiZnVuY3Rpb25cIikpIHRhc2tUeXBlID0gXCJGVU5DVElPTlwiO1xuICAgIGlmIChjb21tYW5kLmluY2x1ZGVzKFwidGVzdGVcIikgfHwgY29tbWFuZC5pbmNsdWRlcyhcInRlc3RcIikpIHRhc2tUeXBlID0gXCJURVNUXCI7XG4gICAgaWYgKGNvbW1hbmQuaW5jbHVkZXMoXCJlc3RpbG9cIikgfHwgY29tbWFuZC5pbmNsdWRlcyhcInN0eWxlXCIpKSB0YXNrVHlwZSA9IFwiU1RZTEVcIjtcbiAgICBpZiAoY29tbWFuZC5pbmNsdWRlcyhcImRvY3VtZW50YcOnw6NvXCIpIHx8IGNvbW1hbmQuaW5jbHVkZXMoXCJkb2N1bWVudGF0aW9uXCIpKVxuICAgICAgdGFza1R5cGUgPSBcIkRPQ1VNRU5UQVRJT05cIjtcbiAgICBpZiAoY29tbWFuZC5pbmNsdWRlcyhcInJlZmF0b3JhclwiKSB8fCBjb21tYW5kLmluY2x1ZGVzKFwicmVmYWN0b3JcIikpIHRhc2tUeXBlID0gXCJSRUZBQ1RPUlwiO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbW1hbmQsXG4gICAgICB0YXNrVHlwZSxcbiAgICAgIGtleXdvcmRzLFxuICAgICAgY29tbWl0TWVzc2FnZTogYGZlYXQ6ICR7Y29tbWFuZC5zdWJzdHJpbmcoMCwgNTApfWAsXG4gICAgICBkZXNjcmlwdGlvbjogY29tbWFuZCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdlcmFyIGPDs2RpZ28gdmlhIElBXG4gICAqL1xuICBhc3luYyBnZW5lcmF0ZUNvZGUoYW5hbHlzaXMsIHNwZWNpYWxpc3QsIHJlcG9zaXRvcnlJbmZvKSB7XG4gICAgLy8gQXF1aSBzZXJpYSBjaGFtYWRhIGEgSUEgKEdlbWluaSwgR1JPUSwgZXRjKVxuICAgIC8vIFBvciBlbnF1YW50bywgc2ltdWxhw6fDo29cblxuICAgIGNvbnNvbGUubG9nKGDwn6SWIEdlcmFuZG8gY8OzZGlnbyBjb20gJHtzcGVjaWFsaXN0fS4uLmApO1xuXG4gICAgLy8gU2ltdWxhciBnZXJhw6fDo28gZGUgY8OzZGlnb1xuICAgIGNvbnN0IGZpbGVzID0gW1xuICAgICAge1xuICAgICAgICBwYXRoOiBgc3JjL2dlbmVyYXRlZF8ke0RhdGUubm93KCl9LmpzYCxcbiAgICAgICAgY29udGVudDogYC8vIEdlcmFkbyBhdXRvbWF0aWNhbWVudGUgcG9yICR7c3BlY2lhbGlzdH1cXG4vLyBUYXJlZmE6ICR7YW5hbHlzaXMuZGVzY3JpcHRpb259XFxuXFxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2VuZXJhdGVkKCkge1xcbiAgLy8gQ8OzZGlnbyBnZXJhZG8gYXF1aVxcbn1cXG5gLFxuICAgICAgfSxcbiAgICBdO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGZpbGVzLFxuICAgICAgdG90YWxMaW5lczogZmlsZXMucmVkdWNlKChzdW0sIGYpID0+IHN1bSArIGYuY29udGVudC5zcGxpdChcIlxcblwiKS5sZW5ndGgsIDApLFxuICAgICAgc3BlY2lhbGlzdCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXIgY8OzZGlnb1xuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVDb2RlKGZpbGVzKSB7XG4gICAgY29uc29sZS5sb2coYPCflI0gVmFsaWRhbmRvICR7ZmlsZXMubGVuZ3RofSBhcnF1aXZvcy4uLmApO1xuXG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdG9yLnZhbGlkYXRlRmlsZXMoZmlsZXMpO1xuXG4gICAgaWYgKCF2YWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGDinYwgVmFsaWRhw6fDo28gZmFsaG91IWApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogZmFsc2UsXG4gICAgICAgIHNldmVyaXR5OiBcImNyaXRpY2FsXCIsXG4gICAgICAgIGVycm9yczogdmFsaWRhdGlvbi5kZXRhaWxzLmZsYXRNYXAoKGQpID0+IGQuZXJyb3JzKSxcbiAgICAgICAgd2FybmluZ3M6IHZhbGlkYXRpb24uZGV0YWlscy5mbGF0TWFwKChkKSA9PiBkLndhcm5pbmdzKSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYOKchSBDw7NkaWdvIHZhbGlkYWRvIGNvbSBzdWNlc3NvIWApO1xuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgc2V2ZXJpdHk6IFwibm9uZVwiLFxuICAgICAgZXJyb3JzOiBbXSxcbiAgICAgIHdhcm5pbmdzOiB2YWxpZGF0aW9uLmRldGFpbHMuZmxhdE1hcCgoZCkgPT4gZC53YXJuaW5ncyksXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGYXplciBjb21taXQgKyBwdXNoXG4gICAqL1xuICBhc3luYyBjb21taXRBbmRQdXNoKGZpbGVzLCBtZXNzYWdlLCByZXBvc2l0b3J5SW5mbywgc3BlY2lhbGlzdCkge1xuICAgIGNvbnNvbGUubG9nKGDwn5OdIEZhemVuZG8gY29tbWl0ICsgcHVzaC4uLmApO1xuXG4gICAgaWYgKCF0aGlzLmdpdEh1Yikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiR2l0SHViIG7Do28gaW5pY2lhbGl6YWRvXCIpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZ2l0SHViLmNvbW1pdEFuZFB1c2goXG4gICAgICByZXBvc2l0b3J5SW5mby5vd25lcixcbiAgICAgIHJlcG9zaXRvcnlJbmZvLnJlcG8sXG4gICAgICBmaWxlcyxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICByZXBvc2l0b3J5SW5mby5icmFuY2ggfHwgXCJtYWluXCIsXG4gICAgICB7XG4gICAgICAgIG5hbWU6IGAke3NwZWNpYWxpc3R9IEJvdGAsXG4gICAgICAgIGVtYWlsOiBgJHtzcGVjaWFsaXN0LnRvTG93ZXJDYXNlKCl9QHJrbW1heC5jb21gLFxuICAgICAgfVxuICAgICk7XG5cbiAgICBjb25zb2xlLmxvZyhg4pyFIENvbW1pdCByZWFsaXphZG86ICR7cmVzdWx0LmNvbW1pdC5zaGEuc3Vic3RyaW5nKDAsIDcpfWApO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmlhciBQdWxsIFJlcXVlc3RcbiAgICovXG4gIGFzeW5jIGNyZWF0ZVB1bGxSZXF1ZXN0KGFuYWx5c2lzLCBzcGVjaWFsaXN0LCByZXBvc2l0b3J5SW5mbykge1xuICAgIGNvbnNvbGUubG9nKGDwn5SAIENyaWFuZG8gUHVsbCBSZXF1ZXN0Li4uYCk7XG5cbiAgICBpZiAoIXRoaXMuZ2l0SHViKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJHaXRIdWIgbsOjbyBpbmljaWFsaXphZG9cIik7XG4gICAgfVxuXG4gICAgY29uc3QgYnJhbmNoTmFtZSA9IGBhdXRvbWF0aW9uLyR7c3BlY2lhbGlzdC50b0xvd2VyQ2FzZSgpfS8ke0RhdGUubm93KCl9YDtcblxuICAgIGNvbnN0IHByID0gYXdhaXQgdGhpcy5naXRIdWIuY3JlYXRlUHVsbFJlcXVlc3QoXG4gICAgICByZXBvc2l0b3J5SW5mby5vd25lcixcbiAgICAgIHJlcG9zaXRvcnlJbmZvLnJlcG8sXG4gICAgICBgWyR7c3BlY2lhbGlzdH1dICR7YW5hbHlzaXMuY29tbWl0TWVzc2FnZX1gLFxuICAgICAgYEF1dG9tYcOnw6NvIGV4ZWN1dGFkYSBwb3IgJHtzcGVjaWFsaXN0fVxcblxcblRhcmVmYTogJHthbmFseXNpcy5kZXNjcmlwdGlvbn1gLFxuICAgICAgYnJhbmNoTmFtZSxcbiAgICAgIHJlcG9zaXRvcnlJbmZvLmJyYW5jaCB8fCBcIm1haW5cIlxuICAgICk7XG5cbiAgICBjb25zb2xlLmxvZyhg4pyFIFBSIGNyaWFkbzogJHtwci51cmx9YCk7XG5cbiAgICByZXR1cm4geyBwciB9O1xuICB9XG5cbiAgLyoqXG4gICAqIE9idGVyIGhpc3TDs3JpY28gZGUgYXV0b21hw6fDtWVzXG4gICAqL1xuICBnZXRBdXRvbWF0aW9uSGlzdG9yeSh1c2VySWQsIGxpbWl0ID0gNTApIHtcbiAgICByZXR1cm4gdGhpcy5hdWRpdExvZ2dlclxuICAgICAgLnNlYXJjaExvZ3Moe1xuICAgICAgICB0eXBlOiBcIkFVVE9NQVRJT05fUkVRVUVTVFwiLFxuICAgICAgICB1c2VySWQsXG4gICAgICB9KVxuICAgICAgLnNsaWNlKC1saW1pdCk7XG4gIH1cblxuICAvKipcbiAgICogT2J0ZXIgZXN0YXTDrXN0aWNhcyBkZSBhdXRvbWHDp8Ojb1xuICAgKi9cbiAgZ2V0QXV0b21hdGlvblN0YXRzKHVzZXJJZCkge1xuICAgIGNvbnN0IGxvZ3MgPSB0aGlzLmF1ZGl0TG9nZ2VyLnNlYXJjaExvZ3MoeyB1c2VySWQgfSk7XG5cbiAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgIHRvdGFsQXV0b21hdGlvbnM6IGxvZ3MubGVuZ3RoLFxuICAgICAgc3VjY2Vzc2Z1bEF1dG9tYXRpb25zOiBsb2dzLmZpbHRlcigobCkgPT4gbC5zdGF0dXMgPT09IFwiU1VDQ0VTU1wiKS5sZW5ndGgsXG4gICAgICBmYWlsZWRBdXRvbWF0aW9uczogbG9ncy5maWx0ZXIoKGwpID0+IGwuc3RhdHVzID09PSBcIkZBSUxFRFwiKS5sZW5ndGgsXG4gICAgICBibG9ja2VkQXV0b21hdGlvbnM6IGxvZ3MuZmlsdGVyKChsKSA9PiBsLnN0YXR1cyA9PT0gXCJCTE9DS0VEXCIpLmxlbmd0aCxcbiAgICAgIGJ5TW9kZToge30sXG4gICAgICBieVNwZWNpYWxpc3Q6IHt9LFxuICAgIH07XG5cbiAgICBsb2dzLmZvckVhY2goKGxvZykgPT4ge1xuICAgICAgaWYgKGxvZy5tb2RlKSB7XG4gICAgICAgIHN0YXRzLmJ5TW9kZVtsb2cubW9kZV0gPSAoc3RhdHMuYnlNb2RlW2xvZy5tb2RlXSB8fCAwKSArIDE7XG4gICAgICB9XG4gICAgICBpZiAobG9nLnNlbGVjdGVkU3BlY2lhbGlzdCkge1xuICAgICAgICBzdGF0cy5ieVNwZWNpYWxpc3RbbG9nLnNlbGVjdGVkU3BlY2lhbGlzdF0gPVxuICAgICAgICAgIChzdGF0cy5ieVNwZWNpYWxpc3RbbG9nLnNlbGVjdGVkU3BlY2lhbGlzdF0gfHwgMCkgKyAxO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAg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